{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"SCALLOP-INF meta-analysis Flow of analysis (When the diagram is not rendered, view it from Mermaid live editor ) graph TB; tryggve ==> cardio; cardio ==> csd3; csd3 --> csd3Analysis[Conditional analysis,finemapping, etc]; csd3 --> software[R Packages at CRAN/GitHub]; tryggveAnalysis[Meta analysis: list.sh, format.sh,metal.sh, QCGWAS.sh, analysis.sh] --> GWAS[pQTL selection and Characterization]; GWAS --> Prototyping[Prototyping: INTERVAL.sh, cardio.sh, ...]; Prototyping --> Multi-omics-analysis; Comments The tryggve , cardio and csd3 directories here are associated with the named Linux cluster(s) used for the analysis over time. Most recent implementations are documented in Supplementary notes . Data pre-processing was done initially from tryggve with list.sh and format.sh , followed by meta-analysis according to metal.sh using METAL whose results were cross-examined with QCGWAS.sh together with additional investigation. The main analysis followed with analysis.sh containing codes for Manhattan/Q-Q/forest/LocusZoom plots such as the OPG example (see the diagram below), which replicated results of Kwan et al. (2014) as identified by PhenoScanner), clumping using PLINK and conditional analysis using GCTA. The clumping results were classified into cis/trans signals. As the meta-analysis stabilised especially with INTERVAL reference, analysis has been intensively done locally with cardio and csd3. cis/trans classification has been done via cis.vs.trans.classification.R as validated by cistrans.sh . We prototyped our analysis on cardio with INTERVAL such as INTERVAL.sh and cardio.sh as well as individual level data analysis for the KORA study. Most analyses were done locally on CSD3. In alphabetical order, the cis.vs.trans.classification , circos.cis.vs.trans.plot , cs , log10p , logp , gc.lambda , get_b_se , get_sdy , get_pve_se , invnormal , METAL_forestplot , mhtplot.trunc , mhtplot2d , pqtl2dplot/pqtl2dplotly/pqtl3dplotly , pvalue functions are now part of R/gap at CRAN or GitHub . Some aspects of the downstream analyses links colocalisation and Mendelian randomisation are also available from gap vignette and pQTLtools articles . A nested predictive model based on genotype data G, which link with proteins P1, P2, ..., Pn as predictors for outcome y. Alternative routes are T(P)WAS with fusion_twas and EWAS with EWAS-fusion . graph TD; G --> P1 G --> P2 G --> ... G --> Pn P1 --> y P2 --> y ... --> y Pn --> y SNP[\"LD reference panel (bed,bim,fam)\"] --> |\"EWAS reference panel(top1, blup, lasso, enet, bslmm)\"| Methylation; Methylation --> Protein; SNP --> |\"GWAS summary statistics (SNP, A1, A2, Z)\"| Protein; The OPG example This proves to be a positive control. The stacked image below shows Manhattan, Q-Q, forest and LocusZoom plots. EWAS with IL-12B (EWAS, joint/conditional) Q-Q and Manhattan plots from ewas-plot.R . Summary statistics The link will be added here when available. Related links OlinkAnalyze Olink Insights Stat Analysis SCALLOP consortium . Olink location , What is NPX , F2F London meeting , Data Science Workshop 2019 . GitHub repository for the 2017 PLoS Genetics paper above. securecloud . Olink publications . SomaLogic plasma protein GWAS summary statistics . Aging Plasma Proteome ( DEswan ). ImmunoBase . Worldwide PDB References Choi SW, Mak TS, O'Reilly PF Tutorial: a guide to performing polygenic risk score analyses. Nat Protoc 15, 2759-2772 (2020), GitHub documentation . Folkersen L, et al. (2017). Mapping of 79 loci for 83 plasma protein biomarkers in cardiovascular disease. PLoS Genetics 13(4), doi.org/10.1371/journal.pgen.1006706. Kwan JSH, et al. (2014). Meta-analysis of genome-wide association studies identi\ufb01es two loci associated with circulating osteoprotegerin levels. Hum Mol Genet 23(24): 6684\u20136693. Niewczas MA, et al. (2019). A signature of circulating inflammatory proteins and development of end-stage renal disease in diabetes. Nat Med . https://doi.org/10.1038/s41591-019-0415-5 Sun BB, et al. (2018). Genomic atlas of the human plasma proteome. Nature 558: 73\u201379.","title":""},{"location":"#scallop-inf-meta-analysis","text":"","title":"SCALLOP-INF meta-analysis"},{"location":"#flow-of-analysis","text":"(When the diagram is not rendered, view it from Mermaid live editor ) graph TB; tryggve ==> cardio; cardio ==> csd3; csd3 --> csd3Analysis[Conditional analysis,finemapping, etc]; csd3 --> software[R Packages at CRAN/GitHub]; tryggveAnalysis[Meta analysis: list.sh, format.sh,metal.sh, QCGWAS.sh, analysis.sh] --> GWAS[pQTL selection and Characterization]; GWAS --> Prototyping[Prototyping: INTERVAL.sh, cardio.sh, ...]; Prototyping --> Multi-omics-analysis;","title":"Flow of analysis"},{"location":"#comments","text":"The tryggve , cardio and csd3 directories here are associated with the named Linux cluster(s) used for the analysis over time. Most recent implementations are documented in Supplementary notes . Data pre-processing was done initially from tryggve with list.sh and format.sh , followed by meta-analysis according to metal.sh using METAL whose results were cross-examined with QCGWAS.sh together with additional investigation. The main analysis followed with analysis.sh containing codes for Manhattan/Q-Q/forest/LocusZoom plots such as the OPG example (see the diagram below), which replicated results of Kwan et al. (2014) as identified by PhenoScanner), clumping using PLINK and conditional analysis using GCTA. The clumping results were classified into cis/trans signals. As the meta-analysis stabilised especially with INTERVAL reference, analysis has been intensively done locally with cardio and csd3. cis/trans classification has been done via cis.vs.trans.classification.R as validated by cistrans.sh . We prototyped our analysis on cardio with INTERVAL such as INTERVAL.sh and cardio.sh as well as individual level data analysis for the KORA study. Most analyses were done locally on CSD3. In alphabetical order, the cis.vs.trans.classification , circos.cis.vs.trans.plot , cs , log10p , logp , gc.lambda , get_b_se , get_sdy , get_pve_se , invnormal , METAL_forestplot , mhtplot.trunc , mhtplot2d , pqtl2dplot/pqtl2dplotly/pqtl3dplotly , pvalue functions are now part of R/gap at CRAN or GitHub . Some aspects of the downstream analyses links colocalisation and Mendelian randomisation are also available from gap vignette and pQTLtools articles . A nested predictive model based on genotype data G, which link with proteins P1, P2, ..., Pn as predictors for outcome y. Alternative routes are T(P)WAS with fusion_twas and EWAS with EWAS-fusion . graph TD; G --> P1 G --> P2 G --> ... G --> Pn P1 --> y P2 --> y ... --> y Pn --> y SNP[\"LD reference panel (bed,bim,fam)\"] --> |\"EWAS reference panel(top1, blup, lasso, enet, bslmm)\"| Methylation; Methylation --> Protein; SNP --> |\"GWAS summary statistics (SNP, A1, A2, Z)\"| Protein;","title":"Comments"},{"location":"#the-opg-example","text":"This proves to be a positive control. The stacked image below shows Manhattan, Q-Q, forest and LocusZoom plots.","title":"The OPG example"},{"location":"#ewas-with-il-12b","text":"(EWAS, joint/conditional) Q-Q and Manhattan plots from ewas-plot.R .","title":"EWAS with IL-12B"},{"location":"#summary-statistics","text":"The link will be added here when available.","title":"Summary statistics"},{"location":"#related-links","text":"OlinkAnalyze Olink Insights Stat Analysis SCALLOP consortium . Olink location , What is NPX , F2F London meeting , Data Science Workshop 2019 . GitHub repository for the 2017 PLoS Genetics paper above. securecloud . Olink publications . SomaLogic plasma protein GWAS summary statistics . Aging Plasma Proteome ( DEswan ). ImmunoBase . Worldwide PDB","title":"Related links"},{"location":"#references","text":"Choi SW, Mak TS, O'Reilly PF Tutorial: a guide to performing polygenic risk score analyses. Nat Protoc 15, 2759-2772 (2020), GitHub documentation . Folkersen L, et al. (2017). Mapping of 79 loci for 83 plasma protein biomarkers in cardiovascular disease. PLoS Genetics 13(4), doi.org/10.1371/journal.pgen.1006706. Kwan JSH, et al. (2014). Meta-analysis of genome-wide association studies identi\ufb01es two loci associated with circulating osteoprotegerin levels. Hum Mol Genet 23(24): 6684\u20136693. Niewczas MA, et al. (2019). A signature of circulating inflammatory proteins and development of end-stage renal disease in diabetes. Nat Med . https://doi.org/10.1038/s41591-019-0415-5 Sun BB, et al. (2018). Genomic atlas of the human plasma proteome. Nature 558: 73\u201379.","title":"References"},{"location":"cardio/","text":"Cardio Cardio is the Linux clusters once used by the Cardiovascular Epidemiology Unit at University of Camrbridge. INTERVAL reference /scratch/jhz22/data/INTERVAL INTERVAL sumstats location: /scratch/jhz22/INF/sumstats/INTERVAL Manhattan plots by cohort location: /scratch/jhz22/INF/plots Meta-analysis sumstats + Manhattan/Q-Q/LocusZoom plots location: /scratch/jhz22/INF/METAL Results based on aproximately independent LD blocks (AILD) See https://bitbucket.org/nygcresearch/ldetect-data SNPs+indels location, /scratch/jhz22/INF/aild cojo/, GCTA --cojo-slct results for all (INF1*) and individual proteins ps/, PhenoScanner v2 results. coded as in /scratch/jhz22/INF/cardio/ps.sh clump/, PLINK --clump results for all (INF1*) and individual proteins SNPs only location, /scratch/jhz22/INF/snps cojo/, GCTA --cojo-slct results for all (INF1*) and individual proteins ps/, PhenoScanner v2 results. lz/, LocusZoom plots clump/, PLINK --clump results for all (INF1*) and individual proteins clump0/ PLINK --clump-r2 0 for independent signals Genomewide results based on slide windows Clumping results location: /scratch/jhz22/INF/clumping Files: study.reference.LD-cutoff.clumped_reults, e.g., INTERVAL.UK10K+1KG.r2-0.1.clumped Conditional/joint analysis location: /scratch/jhz22/INF/cojo Conditional/joint analysis with regions in high LD location: /scratch/jhz22/INF/aild-ld aild-indel/, all variants ps, PhenoScanner v2 and v1.1/ aild-snp/, SNPs only Results from PhenoScanner which contains protein-specific and whole (INF1_ and INF1r_ , see below) results. # those INF1_* # All results, no LD, p=1e-5 # phenoscanner -c All -l No -p 0.00001 -i INF1.ps -o INF1 # revised # All results, no LD, p=1e-7 phenoscanner -c All -l No -p 0.0000001 -i INF1.ps -o INF1r The results on GWAS with LD r2=0.6 in INF1r_* are available from R as follows, R --no-save -q <<END library(MendelianRandomization) # SNPID not possible INF1 <- read.table(\"INF1.ps\",as.is=TRUE) # batches in 100 only INF1 <- with(read.csv(\"INF1_PhenoScanner_SNP_Info.csv\"),rsID) r1 <- phenoscanner(snpquery= INF1[1:100], proxies = \"EUR\", pvalue = 1e-07, r2= 0.6, build=37) r2 <- phenoscanner(snpquery=INF1[101:200], proxies = \"EUR\", pvalue = 1e-07, r2= 0.6, build=37) r3 <- phenoscanner(snpquery=INF1[201:300], proxies = \"EUR\", pvalue = 1e-07, r2= 0.6, build=37) r4 <- phenoscanner(snpquery=INF1[301:376], proxies = \"EUR\", pvalue = 1e-07, r2= 0.6, build=37) save(r1,r2,r3,r4,file=\"INF1r.rda\",version=2) END Approximately independent LD blocks: Set up 1703 autosomal regions as defined in EURLD.bed . Extract variants outside the regions in high LD to 1672 regions by EURLD.sh . Overlap regions and GWAS sumstats: Tag GWAS sumstats with regions through aild-rma.sb . Pair protein-region which contains genomewide significant signals by aild-list.sb . Independently, list variants by region in the reference panel by aild-snplist.sb . clump via aild-clump.sb . cojo via aild-cojo.sb . Downstream analyses with PhenoScanner (preferably v2) as in ps.sh and forest plots on TRYGGVE (with study-specific sumstats). The regions are predefined. As shown in EURLD.tsv by EURLD.R , the LD patterns across the genome are more variable than the norm in a typical genomewide association analysis therefore slide windows such as 250kb (36), 500kb (300), or even 10Mb (1071), seeing that the sentinel variant may not necessarily lie right in the middle of a window. The number of signals in our case were close to GCTA but overestimated (53 by PLINK) as in the following table. For instance, it is often seen from the PLINK --clump-range outputs that sliding windows can give results in two neighbouring LD blocks. Note that pairing regions of interest would reduce the burden of genomewide analysis, and also that region-specific reference will not affect results from steps 4 and 5 regarding use of variants from GWAS sumstats. Steps 4 and 5 both use INF1.aild , which contains all the protein-region pairs. The results are classified as in analysis.sh . In particular, for step 5 this is done with aild.sh . Near-independent signals from cojo and clumping Run Option cis trans total Comments/location + GCTA 1 LD blocks 210 147 357 only SNPs, cojo/aild-snp/INF1.jma.*, also doc/INF1.paper.xlsx + indels LD blocks 220 155 375 SNPs+indels, cojo/aild-indel/INF1.jma.* 2 default 234 173 407 --cojo-collinear 0.9 --cojo-wind 10000, doc/SCALLOP_INF1-260419.xlsx 3 small R2 & window 189 186 375 --cojo-collinear 0.1 --cojo-wind 500, doc/SCALLOP_INF1-260419.xlsx PLINK 4 LD blocks 594 252 846 only SNPs, clumping/aild-snp/INF1.jma.*, also doc/INF1.paper.xlsx + indels LD blocks 621 258 879 SNPs+indels, clumping/aild-indel/INF1.jma.* 5 INTERVAL LD panel 657 275 932 --clump-r2 0.1 --clump-kb 500, doc/SCALLOP_INF1-120419.xlsx 6 1000G LD panel 405 229 634 --clump-r2 0.1 --clump-kb 500, clumping/INF1.1KG.r2-0.1.clumped.* 7 INTERVAL data 424 188 612 --clump-r2 0.1 --clump-kb 500, doc/SCALLOP_INF1-120419.xlsx 8 1000G LD panel 402 226 628 --clump-r2 0.1 --clump-kb 1000, on tryggve + The directories are relative to /scratch/jhz22/INF, i.e., doc/, cojo/ and clumping/, Results in 2 and 3 include regions in high LD excluded in other analyses. A few observations can be made, indels lead to more signals in cojo (1) and clumping (4) analyses. default GCTA --cojo-collinear and --cojo-wind parameters did quite well in numbers, esp. taking ~30 away regions in LD (1, 2). Although it looks close, GCTA --cojo-collinear 0.1 produces considerably less signals compared to --cojo-collinear 0.9 (3). the number of signals increase with the values of GCTA parameters (2, 3), yet moderate changes in LD window have less impact than the reference panel (5, 8). PLINK --clump gives more signals than GCTA --cojo (1, 4 and 2, 5). Specification of sliding LD windows disregarding AILD patterns in clumping gives 53 additional signals (4, 5). Thanks to the larger sample size and perhaps greater variant number, INTERVAL as LD reference leads to more signals than 1000Genomes (5, 6). Summary statistics from larger sample size gives more signals (5, 7). Unpruned results are likely to give more cis signals but this is subject to scrutiny perhaps on individual cases. It can be concluded that it is desirable to employ approximately independent LD blocks for both GCTA (1) and PLINK (4), and also that reference such as UK10K+1KG would be desirable with respect to both sample size and variant number. Date last changed: 23/8/2021","title":"Cardio"},{"location":"cardio/#cardio","text":"Cardio is the Linux clusters once used by the Cardiovascular Epidemiology Unit at University of Camrbridge.","title":"Cardio"},{"location":"cardio/#interval-reference","text":"/scratch/jhz22/data/INTERVAL","title":"INTERVAL reference"},{"location":"cardio/#interval-sumstats","text":"location: /scratch/jhz22/INF/sumstats/INTERVAL","title":"INTERVAL sumstats"},{"location":"cardio/#manhattan-plots-by-cohort","text":"location: /scratch/jhz22/INF/plots","title":"Manhattan plots by cohort"},{"location":"cardio/#meta-analysis-sumstats-manhattanq-qlocuszoom-plots","text":"location: /scratch/jhz22/INF/METAL","title":"Meta-analysis sumstats + Manhattan/Q-Q/LocusZoom plots"},{"location":"cardio/#results-based-on-aproximately-independent-ld-blocks-aild","text":"See https://bitbucket.org/nygcresearch/ldetect-data","title":"Results based on aproximately independent LD blocks (AILD)"},{"location":"cardio/#snpsindels","text":"location, /scratch/jhz22/INF/aild cojo/, GCTA --cojo-slct results for all (INF1*) and individual proteins ps/, PhenoScanner v2 results. coded as in /scratch/jhz22/INF/cardio/ps.sh clump/, PLINK --clump results for all (INF1*) and individual proteins","title":"SNPs+indels"},{"location":"cardio/#snps-only","text":"location, /scratch/jhz22/INF/snps cojo/, GCTA --cojo-slct results for all (INF1*) and individual proteins ps/, PhenoScanner v2 results. lz/, LocusZoom plots clump/, PLINK --clump results for all (INF1*) and individual proteins clump0/ PLINK --clump-r2 0 for independent signals","title":"SNPs only"},{"location":"cardio/#genomewide-results-based-on-slide-windows","text":"","title":"Genomewide results based on slide windows"},{"location":"cardio/#clumping-results","text":"location: /scratch/jhz22/INF/clumping Files: study.reference.LD-cutoff.clumped_reults, e.g., INTERVAL.UK10K+1KG.r2-0.1.clumped","title":"Clumping results"},{"location":"cardio/#conditionaljoint-analysis","text":"location: /scratch/jhz22/INF/cojo","title":"Conditional/joint analysis"},{"location":"cardio/#conditionaljoint-analysis-with-regions-in-high-ld","text":"location: /scratch/jhz22/INF/aild-ld aild-indel/, all variants ps, PhenoScanner v2 and v1.1/ aild-snp/, SNPs only Results from PhenoScanner which contains protein-specific and whole (INF1_ and INF1r_ , see below) results. # those INF1_* # All results, no LD, p=1e-5 # phenoscanner -c All -l No -p 0.00001 -i INF1.ps -o INF1 # revised # All results, no LD, p=1e-7 phenoscanner -c All -l No -p 0.0000001 -i INF1.ps -o INF1r The results on GWAS with LD r2=0.6 in INF1r_* are available from R as follows, R --no-save -q <<END library(MendelianRandomization) # SNPID not possible INF1 <- read.table(\"INF1.ps\",as.is=TRUE) # batches in 100 only INF1 <- with(read.csv(\"INF1_PhenoScanner_SNP_Info.csv\"),rsID) r1 <- phenoscanner(snpquery= INF1[1:100], proxies = \"EUR\", pvalue = 1e-07, r2= 0.6, build=37) r2 <- phenoscanner(snpquery=INF1[101:200], proxies = \"EUR\", pvalue = 1e-07, r2= 0.6, build=37) r3 <- phenoscanner(snpquery=INF1[201:300], proxies = \"EUR\", pvalue = 1e-07, r2= 0.6, build=37) r4 <- phenoscanner(snpquery=INF1[301:376], proxies = \"EUR\", pvalue = 1e-07, r2= 0.6, build=37) save(r1,r2,r3,r4,file=\"INF1r.rda\",version=2) END","title":"Conditional/joint analysis with regions in high LD"},{"location":"cardio/#approximately-independent-ld-blocks","text":"Set up 1703 autosomal regions as defined in EURLD.bed . Extract variants outside the regions in high LD to 1672 regions by EURLD.sh . Overlap regions and GWAS sumstats: Tag GWAS sumstats with regions through aild-rma.sb . Pair protein-region which contains genomewide significant signals by aild-list.sb . Independently, list variants by region in the reference panel by aild-snplist.sb . clump via aild-clump.sb . cojo via aild-cojo.sb . Downstream analyses with PhenoScanner (preferably v2) as in ps.sh and forest plots on TRYGGVE (with study-specific sumstats). The regions are predefined. As shown in EURLD.tsv by EURLD.R , the LD patterns across the genome are more variable than the norm in a typical genomewide association analysis therefore slide windows such as 250kb (36), 500kb (300), or even 10Mb (1071), seeing that the sentinel variant may not necessarily lie right in the middle of a window. The number of signals in our case were close to GCTA but overestimated (53 by PLINK) as in the following table. For instance, it is often seen from the PLINK --clump-range outputs that sliding windows can give results in two neighbouring LD blocks. Note that pairing regions of interest would reduce the burden of genomewide analysis, and also that region-specific reference will not affect results from steps 4 and 5 regarding use of variants from GWAS sumstats. Steps 4 and 5 both use INF1.aild , which contains all the protein-region pairs. The results are classified as in analysis.sh . In particular, for step 5 this is done with aild.sh .","title":"Approximately independent LD blocks:"},{"location":"cardio/#near-independent-signals-from-cojo-and-clumping","text":"Run Option cis trans total Comments/location + GCTA 1 LD blocks 210 147 357 only SNPs, cojo/aild-snp/INF1.jma.*, also doc/INF1.paper.xlsx + indels LD blocks 220 155 375 SNPs+indels, cojo/aild-indel/INF1.jma.* 2 default 234 173 407 --cojo-collinear 0.9 --cojo-wind 10000, doc/SCALLOP_INF1-260419.xlsx 3 small R2 & window 189 186 375 --cojo-collinear 0.1 --cojo-wind 500, doc/SCALLOP_INF1-260419.xlsx PLINK 4 LD blocks 594 252 846 only SNPs, clumping/aild-snp/INF1.jma.*, also doc/INF1.paper.xlsx + indels LD blocks 621 258 879 SNPs+indels, clumping/aild-indel/INF1.jma.* 5 INTERVAL LD panel 657 275 932 --clump-r2 0.1 --clump-kb 500, doc/SCALLOP_INF1-120419.xlsx 6 1000G LD panel 405 229 634 --clump-r2 0.1 --clump-kb 500, clumping/INF1.1KG.r2-0.1.clumped.* 7 INTERVAL data 424 188 612 --clump-r2 0.1 --clump-kb 500, doc/SCALLOP_INF1-120419.xlsx 8 1000G LD panel 402 226 628 --clump-r2 0.1 --clump-kb 1000, on tryggve + The directories are relative to /scratch/jhz22/INF, i.e., doc/, cojo/ and clumping/, Results in 2 and 3 include regions in high LD excluded in other analyses. A few observations can be made, indels lead to more signals in cojo (1) and clumping (4) analyses. default GCTA --cojo-collinear and --cojo-wind parameters did quite well in numbers, esp. taking ~30 away regions in LD (1, 2). Although it looks close, GCTA --cojo-collinear 0.1 produces considerably less signals compared to --cojo-collinear 0.9 (3). the number of signals increase with the values of GCTA parameters (2, 3), yet moderate changes in LD window have less impact than the reference panel (5, 8). PLINK --clump gives more signals than GCTA --cojo (1, 4 and 2, 5). Specification of sliding LD windows disregarding AILD patterns in clumping gives 53 additional signals (4, 5). Thanks to the larger sample size and perhaps greater variant number, INTERVAL as LD reference leads to more signals than 1000Genomes (5, 6). Summary statistics from larger sample size gives more signals (5, 7). Unpruned results are likely to give more cis signals but this is subject to scrutiny perhaps on individual cases. It can be concluded that it is desirable to employ approximately independent LD blocks for both GCTA (1) and PLINK (4), and also that reference such as UK10K+1KG would be desirable with respect to both sample size and variant number. Date last changed: 23/8/2021","title":"Near-independent signals from cojo and clumping"},{"location":"csd3/","text":"CSD3 CSD3 is the HPC Linux clusters used at the University of Cambridge, with which this document is associated. NOTE : merge.sh and INTERVAL-fm.ini now work directly with the original INTERVAL bgen files. The alphabetical list is as follows. 3d scatter plot Furnished with js.R , the JSON output could be used as data in the Supplementary Figure 1 of Sun et al. (2018). Annotation annotate.sh involves ANNOVAR , PolyPhen 2 , VEP and some R packages. Known variants lookup.sh , which uses PhenoScanner output from pqtl.R , can be used to check if pQTLs were known. File cvd1.sh gives sentinels overlapped with CVD I as well as LD information corresponding to each protein. LD reference panels The .sh versions below extract data from INTERVAL and ukb, each calling a .sb to generate binary_ped with SNPIDs (bgen/ map) * by qctool -- it also creates bgen with SNPIDs (ukb/nodup) to avoid hard-called genotypes. * by PLINK * -- it has a _snpid tag. In both cases duplicates (bgen/*rmdup.list) are excluded. The utility INTERVAL.sh extracts data from /DO-NOT-MODIFY-SCRATCH/bp406/data_sets/interval_subset_olink/genotype_files/unrelated_4994_pihat_0.1875_autosomal_typed_only /DO-NOT-MODIFY-SCRATCH/bp406/data_sets/interval_subset_olink/genotype_files/unrelated_4994_pihat_0.1875_autosomal_imputed_info_0.4_phwe_1e-4_filtered/per_chr on Cardio into region-specific data in bgen format according to work/INF1.merge. The utility ukb.sh extracts data from ukb_imp_chr[x-xx]_v3.bgen as in /DO-NOT-MODIFY-SCRATCH/uk_biobank/500k/imputed_v3 /DO-NOT-MODIFY-SCRATCH/curated_genetic_data/uk_biobank/reference_files/full_release on Cardio into region-specific data in bgen format (ukb/bgen) according to work/INF1.merge. SNPID-rsid mappings, conditional analysis and finemapping This is furnished with snpid_rsid.sb , whose results will be attached to GCTA / finemap results via finemap.R , slct.R and jam.R . After that, it is ready to use script slct.sb followed by slct.sh . Optionally, the results are fed into finemap.sb via --n-causal-snps . finemap.sb uses the unpruned version. fm.sb and INTERVAL-fm.sb use pruned variants to compromise JAM . The .z file is also appropriate for both finemap and JAM . INTERVAL-fm.sh and INTERVAL-fm.ini works on INTERVAL data. # ldstore v1.1 export pr=IL.6-chr1:154426970_A_C ldstore --bcor ${pr} --bgen ${pr}.bgen ldstore --bcor ${pr} --merge 1 ldstore --bcor ${pr} --matrix ${pr}.ld # ldstore 2 (and finemap-1.4) ldstore --in-files ${pr}.master2 --write-bcor --write-bdose finemap --sss --in-files ${pr}.master2 --n-causal-snps 10 where ${pr}.master2 contains two lines, z;bgen;bgi;bcor;bdose;snp;config;cred;log;n_samples IL.6-chr1:154426970_A_C.z;IL.6-chr1:154426970_A_C.bgen;IL.6-chr1:154426970_A_C.bgi;IL.6-chr1:154426970_A_C.bcor;IL.6-chr1:154426970_A_C.bdose;IL.6-chr1:154426970_A_C.snp;IL.6-chr1:154426970_A_C.config;IL.6-chr1:154426970_A_C.cred;IL.6-chr1:154426970_A_C.log;4994 The environmental variable LDREF provides an option to use either INTERVAL or UKB data. Low abundance check This is down with qc.sh . PGS These are prsice.sh and pgs.sh for the CRP example. PhenoScanner This is furnished with ps.sh . QQ and Manhattan plots The version for meta-analysis was part of analysis.sh at tryggve/. qqman.sh calls turboqq and turboman by Bram Prins. Sentinel identification This is now furnished with merge.sh . Clumping by fixed distance is superseded with its failure to handle long LD regions. There are scripts for heritability analysis and proportion of variance explained. Trans-pQTL hotspots and proteins as polygenic targets This is illustrated with circos plots and by default this works on work/INF1.merge.cis.vs.trans and requires glist-hg19 . Because circos plots are gene-centric, in both cases, the protein-coding gene is handled in mind. Try ./hotspot.sh chr1:159175354_A_G ./hotspot.sh chr12:111884608_C_T giving results linking ACKR1 and SH2B3 , respectively, while ./polygene.sh IL12B ./polygene.sh TNFSF10 linking IL.12B and TRAIL, respectively. To generate all possible plots, wo do for h in $(cut -f6 work/INF1.merge | sed '1d' | sort -k1,1 | uniq); do echo $h; hotspot.sh $h; done for g in $(cat work/INF1.merge.gene); do echo $g; polygene.sh $g; done Date laste changed: 7/10/2021","title":"CSD3"},{"location":"csd3/#csd3","text":"CSD3 is the HPC Linux clusters used at the University of Cambridge, with which this document is associated. NOTE : merge.sh and INTERVAL-fm.ini now work directly with the original INTERVAL bgen files. The alphabetical list is as follows.","title":"CSD3"},{"location":"csd3/#3d-scatter-plot","text":"Furnished with js.R , the JSON output could be used as data in the Supplementary Figure 1 of Sun et al. (2018).","title":"3d scatter plot"},{"location":"csd3/#annotation","text":"annotate.sh involves ANNOVAR , PolyPhen 2 , VEP and some R packages.","title":"Annotation"},{"location":"csd3/#known-variants","text":"lookup.sh , which uses PhenoScanner output from pqtl.R , can be used to check if pQTLs were known. File cvd1.sh gives sentinels overlapped with CVD I as well as LD information corresponding to each protein.","title":"Known variants"},{"location":"csd3/#ld-reference-panels","text":"The .sh versions below extract data from INTERVAL and ukb, each calling a .sb to generate binary_ped with SNPIDs (bgen/ map) * by qctool -- it also creates bgen with SNPIDs (ukb/nodup) to avoid hard-called genotypes. * by PLINK * -- it has a _snpid tag. In both cases duplicates (bgen/*rmdup.list) are excluded. The utility INTERVAL.sh extracts data from /DO-NOT-MODIFY-SCRATCH/bp406/data_sets/interval_subset_olink/genotype_files/unrelated_4994_pihat_0.1875_autosomal_typed_only /DO-NOT-MODIFY-SCRATCH/bp406/data_sets/interval_subset_olink/genotype_files/unrelated_4994_pihat_0.1875_autosomal_imputed_info_0.4_phwe_1e-4_filtered/per_chr on Cardio into region-specific data in bgen format according to work/INF1.merge. The utility ukb.sh extracts data from ukb_imp_chr[x-xx]_v3.bgen as in /DO-NOT-MODIFY-SCRATCH/uk_biobank/500k/imputed_v3 /DO-NOT-MODIFY-SCRATCH/curated_genetic_data/uk_biobank/reference_files/full_release on Cardio into region-specific data in bgen format (ukb/bgen) according to work/INF1.merge.","title":"LD reference panels"},{"location":"csd3/#snpid-rsid-mappings-conditional-analysis-and-finemapping","text":"This is furnished with snpid_rsid.sb , whose results will be attached to GCTA / finemap results via finemap.R , slct.R and jam.R . After that, it is ready to use script slct.sb followed by slct.sh . Optionally, the results are fed into finemap.sb via --n-causal-snps . finemap.sb uses the unpruned version. fm.sb and INTERVAL-fm.sb use pruned variants to compromise JAM . The .z file is also appropriate for both finemap and JAM . INTERVAL-fm.sh and INTERVAL-fm.ini works on INTERVAL data. # ldstore v1.1 export pr=IL.6-chr1:154426970_A_C ldstore --bcor ${pr} --bgen ${pr}.bgen ldstore --bcor ${pr} --merge 1 ldstore --bcor ${pr} --matrix ${pr}.ld # ldstore 2 (and finemap-1.4) ldstore --in-files ${pr}.master2 --write-bcor --write-bdose finemap --sss --in-files ${pr}.master2 --n-causal-snps 10 where ${pr}.master2 contains two lines, z;bgen;bgi;bcor;bdose;snp;config;cred;log;n_samples IL.6-chr1:154426970_A_C.z;IL.6-chr1:154426970_A_C.bgen;IL.6-chr1:154426970_A_C.bgi;IL.6-chr1:154426970_A_C.bcor;IL.6-chr1:154426970_A_C.bdose;IL.6-chr1:154426970_A_C.snp;IL.6-chr1:154426970_A_C.config;IL.6-chr1:154426970_A_C.cred;IL.6-chr1:154426970_A_C.log;4994 The environmental variable LDREF provides an option to use either INTERVAL or UKB data.","title":"SNPID-rsid mappings, conditional analysis and finemapping"},{"location":"csd3/#low-abundance-check","text":"This is down with qc.sh .","title":"Low abundance check"},{"location":"csd3/#pgs","text":"These are prsice.sh and pgs.sh for the CRP example.","title":"PGS"},{"location":"csd3/#phenoscanner","text":"This is furnished with ps.sh .","title":"PhenoScanner"},{"location":"csd3/#qq-and-manhattan-plots","text":"The version for meta-analysis was part of analysis.sh at tryggve/. qqman.sh calls turboqq and turboman by Bram Prins.","title":"QQ and Manhattan plots"},{"location":"csd3/#sentinel-identification","text":"This is now furnished with merge.sh . Clumping by fixed distance is superseded with its failure to handle long LD regions. There are scripts for heritability analysis and proportion of variance explained.","title":"Sentinel identification"},{"location":"csd3/#trans-pqtl-hotspots-and-proteins-as-polygenic-targets","text":"This is illustrated with circos plots and by default this works on work/INF1.merge.cis.vs.trans and requires glist-hg19 . Because circos plots are gene-centric, in both cases, the protein-coding gene is handled in mind. Try ./hotspot.sh chr1:159175354_A_G ./hotspot.sh chr12:111884608_C_T giving results linking ACKR1 and SH2B3 , respectively, while ./polygene.sh IL12B ./polygene.sh TNFSF10 linking IL.12B and TRAIL, respectively. To generate all possible plots, wo do for h in $(cut -f6 work/INF1.merge | sed '1d' | sort -k1,1 | uniq); do echo $h; hotspot.sh $h; done for g in $(cat work/INF1.merge.gene); do echo $g; polygene.sh $g; done Date laste changed: 7/10/2021","title":"Trans-pQTL hotspots and proteins as polygenic targets"},{"location":"doc/SCALLOP_INF1_analysis_plan/","text":"Analysis plan SCALLOP consortium analysis plan (also SCALLOP_INF1_analysis_plan.docx ) for Olink/INFlammation panel proteins Adapted from SCALLOP/CVD1 analysis plan, last updated 27/2/2019 Timeline for completing cohort-specific analyses and uploading the results for this project: 31 December 2018 1. Overview The SCAndinavian coLLaboration for Olink plasma Protein genetics (SCALLOP) consortium, https://www.olink.com/scallop/, is a collaborative framework for discovery and follow-up of genetic associations with proteins on the Olink Proteomics platform. A meta-analysis has been conducted on Olink CVD1 panel data from participating cohorts; consequent requests were sent and contributions made on the Olink INF panel. This document follows closely the SCALLOP/CVD1 analysis plan for the analysis, and in particular highlights relevant information required to facilitate the meta-analysis. As with the CVD1 meta-analysis, the tasks will involve Identification of pQTLs in SCALLOP discovery cohorts Study of pQTLs in replication cohorts Investigation of the mechanistic basis of identified cis- and trans-pQTL by functional annotation Examination of pQTL pleiotropic effects Evaluation over the causal role of INF proteins disease outcomes such as CHD and stroke Other downstream analysis 2. Data and analysis Proteins The Olink INFlammation panel of 92 proteins, e.g, https://github.com/jinghuazhao/INF/blob/master/doc/olink.inf.panel.annot.tsv. SNPs 1000 genomes imputation, build 37 (hg19) positions. SNPs filtering on imputation quality at time of meta-analysis. Quality control on aspects such as SNP/sample call rates, gender mismatch, abnormal inbreeding coefficient, failed cryptic relatedness test, ancestry outlier, heterozygosity and Hardy-Weinberg equilibrium test. Association analysis Rank-based inverse normal transformation on the raw measurement of proteins including those below lower limit of detection, e.g., via invnormal function, invnormal <- function(x) qnorm((rank(x,na.last=\"keep\")-0.5)/sum(!is.na(x))) Multiple linear regression for all samples including sex, age, principal components and other cohort specific covariates. Additive genetic model For case-control data, cases and controls are analysed separately \u2013 results will be merged at meta-analysis stage Software It is preferable to use software which account for genotype uncertainty, such as SNPTEST, QUICKTEST, and BOLT-LMM. 3. Descriptive statistics A Google sheet has been set up for filling up the information online: https://tinyurl.com/y9sw8b5u Alternatively, you can use the Excel spreadsheet from this repository. 4. File formats for GWAS results SNP table for GWAS results Please include the following columns. Missing values are coded as \u201cNA\u201d. No Variable name Description of variable 1 SNPID CHR:POS_A1_A2 (such that A1<A2) or rsid 2 CHR Chromosome number 3 POS Physical position for the reference sequence (please indicate NCBI build in descriptive file) 4 STRAND Indicator of strand direction. Please specify \u201c+\u201d if positive or forward strand and \u201c-\u201d if negative or reverse strand. 5 N Number of non-missing observations 6 EFFECT_ALLELE Allele for which the effect (beta coefficient) is reported. For example, in an A/G SNP in which AA = 0, AG=1, and GG=2, the coded allele is G. 7 REFERENCE_ALLELE Second allele at the SNP (the other allele). In the example above, the non-coded allele is A. 8 CODE_ALL_FQ Allele frequency for the coded allele \u2013 \u201cNA\u201d if not available 9 BETA Effect size for the coded allele, beta estimate from the genotype-phenotype association, with at least 5 decimal places. Note: if not available, please report \u201cNA\u201d for this variable. 10 SE Standard error of the beta estimate, to at least 5 decimal places - \u201cNA\u201d if not available. 11 PVAL p-value of Wald test statistic \u2013 \u201cNA\u201d if not available 12 RSQ Residual phenotypic variance explained by SNP. \u201cNA\u201d if not available 13 RSQ_IMP Observed divided by expected variance for imputed allele dosage. 14 IMP Please specify whether the SNP was imputed or genotyped: 1: imputed SNP, 0: directly genotyped SNP File-naming convention It is recommended to use format STUDY_analyst_inf1_protein_UniProtID_date.gz, see https://www.uniprot.org/ for additional information on UniProt IDs. Notes on PLINK Due possibly to the large number of proteins for GWAS, some cohorts employed PLINK to expedite analysis with which one may see the following information: No Name Description Additional comment 1 BP Position in base pairs 2 CHR Chromosome 3 SNP CHR:POS_A1_A2 or rsid 4* HWE Hardy-Weinberg equilibrium P-value 5* MAF Minor allele frequency Please indicate if this is the effect allele frequency 6 A1 Allele 1 Please indicate if this is the effect/reference allele 7* A2 Allele 2 Please indicate if this is the effect/reference allele 8 NMISS Sample size 9 BETA Regression coefficient 10 STAT Regression test statistic 11 P P value * may be taken from the PLINK --hardy option and .bim file, see http://zzz.bwh.harvard.edu/plink/anal.shtml#glm. In this case, please provide for each SNP information on strand, effect allele, effect allele frequency, and the information measures for imputation -- the information measure can be on the genotype level obtained once for a cohort rather than from phenotype-genotype regression through software such as SNPTEST. SNP and sample based statistics can be greatly facilitated with software qctool, http://www.well.ox.ac.uk/~gav/qctool_v2/. As is the case with INTERVAL.bgen and INTERVAL.sample, one can obtain the SNP-based statistics as follows, qctool -g INTERVAL.bgen -s INTERVAL.sample -snp-stats -osnp INTERVAL.snp-stats -sample-stats -osample INTERVAL.sample-stats See also the full SLURM sbatch script in the Appendix. When a dosage format is used, PLINK also gives an INFO measure; see http://zzz.bwh.harvard.edu/plink/dosage.shtml. However, per-SNP sample size is not given, which again could be obtained from qctool as described above. 5. Meta-analysis Meta-analysis will be performed centrally using the inverse-N weighted analysis of regression betas and standard errors, as implemented in the software METAL (https://github.com/statgen/METAL). Genomic control and appropriate marker filters will be applied at this stage. Marker exclusion filters : we will apply imputation quality filters at the meta-analysis stage, so provide unfiltered results. Genomic control (GC) : genomic control will be applied at the meta-analysis stage (single GC), so GC-correction is not needed for each cohort. Significance : the Bonferroni threshold for the genome-wide analyses will be set at 5 x 10 -10 . The results will be replicated in independent cohorts. 6. Uploading of results See the CVD1 analysis plan. 7. Contact information For general questions about SCALLOP, please contact Anders Malarstig (anders.malarstig@ki.se). For technical issues about TRYGGVE, please contact Lasse Folkersen (lasfol@cbs.dtu.dk). For questions regarding SCALLOP/INF, please contact Jing Hua Zhao (jhz22@medschl.cam.ac.uk) and James Peters (jp549@medschl.cam.ac.uk). Appendix SLURM script for qctool 2.0.1 This is called with sbatch qctool.sb , where qctool.sb contains the following lines: #!/bin/bash --login #SBATCH -J qctool #SBATCH -o qctool.log #SBATCH -p long #SBATCH -t 4-0:0 #SBATCH --export ALL #SBATCH --nodes=1 #SBATCH --ntasks-per-node=1 #SBATCH --cpus-per-task=8 export DIR=/scratch/bp406/data_sets/interval_subset_olink/genotype_files/unrelated_4994_pihat_0.1875_autosomal_typed_only export INTERVAL=$DIR/interval_olink_subset_unrelated_4994_pihat_0.1875_autosomal_typed_only ln -sf $INTERVAL.bgen INTERVAL.bgen ln -sf $INTERVAL.sample INTERVAL.sample # to obtain SNP-specific statistics as in .bgen and .sample format with qctool, tested with qctool 2.0.1 qctool -g INTERVAL.bgen -s INTERVAL.sample -snp-stats -osnp INTERVAL.snp-stats -sample-stats -osample INTERVAL.sample-stats # Note in particular: the # option allows for chromosome-specific analysis; the -strand option will enable results in positive strand. The following obtains SNP-specific statistics by chromosome. #!/bin/bash --login #SBATCH -J qctool #SBATCH -o qctool.log #SBATCH -p long #SBATCH -a 1-22 #SBATCH -t 4-0:0 #SBATCH --export ALL #SBATCH --nodes=1 #SBATCH --ntasks-per-node=1 #SBATCH --cpus-per-task=8 export DIR=/scratch/bp406/data_sets/interval_subset_olink/genotype_files/unrelated_4994_pihat_0.1875_autosomal_typed_only/per_chr export INTERVAL=$DIR/interval_olink_subset_unrelated_4994_pihat_0.1875_autosomal_typed_only_chr_ export chr=$SLURM_ARRAY_TASK_ID qctool -g ${INTERVAL}${chr}.bgen -s ${INTERVAL}${chr}.sample -snp-stats -osnp INTERVAL-${chr}.snp-stats","title":"Analysis plan"},{"location":"doc/SCALLOP_INF1_analysis_plan/#analysis-plan","text":"SCALLOP consortium analysis plan (also SCALLOP_INF1_analysis_plan.docx ) for Olink/INFlammation panel proteins Adapted from SCALLOP/CVD1 analysis plan, last updated 27/2/2019 Timeline for completing cohort-specific analyses and uploading the results for this project: 31 December 2018","title":"Analysis plan"},{"location":"doc/SCALLOP_INF1_analysis_plan/#1-overview","text":"The SCAndinavian coLLaboration for Olink plasma Protein genetics (SCALLOP) consortium, https://www.olink.com/scallop/, is a collaborative framework for discovery and follow-up of genetic associations with proteins on the Olink Proteomics platform. A meta-analysis has been conducted on Olink CVD1 panel data from participating cohorts; consequent requests were sent and contributions made on the Olink INF panel. This document follows closely the SCALLOP/CVD1 analysis plan for the analysis, and in particular highlights relevant information required to facilitate the meta-analysis. As with the CVD1 meta-analysis, the tasks will involve Identification of pQTLs in SCALLOP discovery cohorts Study of pQTLs in replication cohorts Investigation of the mechanistic basis of identified cis- and trans-pQTL by functional annotation Examination of pQTL pleiotropic effects Evaluation over the causal role of INF proteins disease outcomes such as CHD and stroke Other downstream analysis","title":"1. Overview"},{"location":"doc/SCALLOP_INF1_analysis_plan/#2-data-and-analysis","text":"","title":"2. Data and analysis"},{"location":"doc/SCALLOP_INF1_analysis_plan/#proteins","text":"The Olink INFlammation panel of 92 proteins, e.g, https://github.com/jinghuazhao/INF/blob/master/doc/olink.inf.panel.annot.tsv.","title":"Proteins"},{"location":"doc/SCALLOP_INF1_analysis_plan/#snps","text":"1000 genomes imputation, build 37 (hg19) positions. SNPs filtering on imputation quality at time of meta-analysis. Quality control on aspects such as SNP/sample call rates, gender mismatch, abnormal inbreeding coefficient, failed cryptic relatedness test, ancestry outlier, heterozygosity and Hardy-Weinberg equilibrium test.","title":"SNPs"},{"location":"doc/SCALLOP_INF1_analysis_plan/#association-analysis","text":"Rank-based inverse normal transformation on the raw measurement of proteins including those below lower limit of detection, e.g., via invnormal function, invnormal <- function(x) qnorm((rank(x,na.last=\"keep\")-0.5)/sum(!is.na(x))) Multiple linear regression for all samples including sex, age, principal components and other cohort specific covariates. Additive genetic model For case-control data, cases and controls are analysed separately \u2013 results will be merged at meta-analysis stage","title":"Association analysis"},{"location":"doc/SCALLOP_INF1_analysis_plan/#software","text":"It is preferable to use software which account for genotype uncertainty, such as SNPTEST, QUICKTEST, and BOLT-LMM.","title":"Software"},{"location":"doc/SCALLOP_INF1_analysis_plan/#3-descriptive-statistics","text":"A Google sheet has been set up for filling up the information online: https://tinyurl.com/y9sw8b5u Alternatively, you can use the Excel spreadsheet from this repository.","title":"3. Descriptive statistics"},{"location":"doc/SCALLOP_INF1_analysis_plan/#4-file-formats-for-gwas-results","text":"","title":"4. File formats for GWAS results"},{"location":"doc/SCALLOP_INF1_analysis_plan/#snp-table-for-gwas-results","text":"Please include the following columns. Missing values are coded as \u201cNA\u201d. No Variable name Description of variable 1 SNPID CHR:POS_A1_A2 (such that A1<A2) or rsid 2 CHR Chromosome number 3 POS Physical position for the reference sequence (please indicate NCBI build in descriptive file) 4 STRAND Indicator of strand direction. Please specify \u201c+\u201d if positive or forward strand and \u201c-\u201d if negative or reverse strand. 5 N Number of non-missing observations 6 EFFECT_ALLELE Allele for which the effect (beta coefficient) is reported. For example, in an A/G SNP in which AA = 0, AG=1, and GG=2, the coded allele is G. 7 REFERENCE_ALLELE Second allele at the SNP (the other allele). In the example above, the non-coded allele is A. 8 CODE_ALL_FQ Allele frequency for the coded allele \u2013 \u201cNA\u201d if not available 9 BETA Effect size for the coded allele, beta estimate from the genotype-phenotype association, with at least 5 decimal places. Note: if not available, please report \u201cNA\u201d for this variable. 10 SE Standard error of the beta estimate, to at least 5 decimal places - \u201cNA\u201d if not available. 11 PVAL p-value of Wald test statistic \u2013 \u201cNA\u201d if not available 12 RSQ Residual phenotypic variance explained by SNP. \u201cNA\u201d if not available 13 RSQ_IMP Observed divided by expected variance for imputed allele dosage. 14 IMP Please specify whether the SNP was imputed or genotyped: 1: imputed SNP, 0: directly genotyped SNP","title":"SNP table for GWAS results"},{"location":"doc/SCALLOP_INF1_analysis_plan/#file-naming-convention","text":"It is recommended to use format STUDY_analyst_inf1_protein_UniProtID_date.gz, see https://www.uniprot.org/ for additional information on UniProt IDs.","title":"File-naming convention"},{"location":"doc/SCALLOP_INF1_analysis_plan/#notes-on-plink","text":"Due possibly to the large number of proteins for GWAS, some cohorts employed PLINK to expedite analysis with which one may see the following information: No Name Description Additional comment 1 BP Position in base pairs 2 CHR Chromosome 3 SNP CHR:POS_A1_A2 or rsid 4* HWE Hardy-Weinberg equilibrium P-value 5* MAF Minor allele frequency Please indicate if this is the effect allele frequency 6 A1 Allele 1 Please indicate if this is the effect/reference allele 7* A2 Allele 2 Please indicate if this is the effect/reference allele 8 NMISS Sample size 9 BETA Regression coefficient 10 STAT Regression test statistic 11 P P value * may be taken from the PLINK --hardy option and .bim file, see http://zzz.bwh.harvard.edu/plink/anal.shtml#glm. In this case, please provide for each SNP information on strand, effect allele, effect allele frequency, and the information measures for imputation -- the information measure can be on the genotype level obtained once for a cohort rather than from phenotype-genotype regression through software such as SNPTEST. SNP and sample based statistics can be greatly facilitated with software qctool, http://www.well.ox.ac.uk/~gav/qctool_v2/. As is the case with INTERVAL.bgen and INTERVAL.sample, one can obtain the SNP-based statistics as follows, qctool -g INTERVAL.bgen -s INTERVAL.sample -snp-stats -osnp INTERVAL.snp-stats -sample-stats -osample INTERVAL.sample-stats See also the full SLURM sbatch script in the Appendix. When a dosage format is used, PLINK also gives an INFO measure; see http://zzz.bwh.harvard.edu/plink/dosage.shtml. However, per-SNP sample size is not given, which again could be obtained from qctool as described above.","title":"Notes on PLINK"},{"location":"doc/SCALLOP_INF1_analysis_plan/#5-meta-analysis","text":"Meta-analysis will be performed centrally using the inverse-N weighted analysis of regression betas and standard errors, as implemented in the software METAL (https://github.com/statgen/METAL). Genomic control and appropriate marker filters will be applied at this stage. Marker exclusion filters : we will apply imputation quality filters at the meta-analysis stage, so provide unfiltered results. Genomic control (GC) : genomic control will be applied at the meta-analysis stage (single GC), so GC-correction is not needed for each cohort. Significance : the Bonferroni threshold for the genome-wide analyses will be set at 5 x 10 -10 . The results will be replicated in independent cohorts.","title":"5. Meta-analysis"},{"location":"doc/SCALLOP_INF1_analysis_plan/#6-uploading-of-results","text":"See the CVD1 analysis plan.","title":"6. Uploading of results"},{"location":"doc/SCALLOP_INF1_analysis_plan/#7-contact-information","text":"For general questions about SCALLOP, please contact Anders Malarstig (anders.malarstig@ki.se). For technical issues about TRYGGVE, please contact Lasse Folkersen (lasfol@cbs.dtu.dk). For questions regarding SCALLOP/INF, please contact Jing Hua Zhao (jhz22@medschl.cam.ac.uk) and James Peters (jp549@medschl.cam.ac.uk).","title":"7. Contact information"},{"location":"doc/SCALLOP_INF1_analysis_plan/#appendix","text":"SLURM script for qctool 2.0.1 This is called with sbatch qctool.sb , where qctool.sb contains the following lines: #!/bin/bash --login #SBATCH -J qctool #SBATCH -o qctool.log #SBATCH -p long #SBATCH -t 4-0:0 #SBATCH --export ALL #SBATCH --nodes=1 #SBATCH --ntasks-per-node=1 #SBATCH --cpus-per-task=8 export DIR=/scratch/bp406/data_sets/interval_subset_olink/genotype_files/unrelated_4994_pihat_0.1875_autosomal_typed_only export INTERVAL=$DIR/interval_olink_subset_unrelated_4994_pihat_0.1875_autosomal_typed_only ln -sf $INTERVAL.bgen INTERVAL.bgen ln -sf $INTERVAL.sample INTERVAL.sample # to obtain SNP-specific statistics as in .bgen and .sample format with qctool, tested with qctool 2.0.1 qctool -g INTERVAL.bgen -s INTERVAL.sample -snp-stats -osnp INTERVAL.snp-stats -sample-stats -osample INTERVAL.sample-stats # Note in particular: the # option allows for chromosome-specific analysis; the -strand option will enable results in positive strand. The following obtains SNP-specific statistics by chromosome. #!/bin/bash --login #SBATCH -J qctool #SBATCH -o qctool.log #SBATCH -p long #SBATCH -a 1-22 #SBATCH -t 4-0:0 #SBATCH --export ALL #SBATCH --nodes=1 #SBATCH --ntasks-per-node=1 #SBATCH --cpus-per-task=8 export DIR=/scratch/bp406/data_sets/interval_subset_olink/genotype_files/unrelated_4994_pihat_0.1875_autosomal_typed_only/per_chr export INTERVAL=$DIR/interval_olink_subset_unrelated_4994_pihat_0.1875_autosomal_typed_only_chr_ export chr=$SLURM_ARRAY_TASK_ID qctool -g ${INTERVAL}${chr}.bgen -s ${INTERVAL}${chr}.sample -snp-stats -osnp INTERVAL-${chr}.snp-stats","title":"Appendix"},{"location":"rsid/","text":"Supplementary notes This page was initiated with conditional analysis and fine-mapping, and now expanded with many other threads of the analysis. Signal selection This is illustrated with neale.sh for Neale UKB data (HbA1c). Conditional analysis and fine-mapping The INTERVAL data is used as reference panel. The logic of this specific directory is a simple solution of the dilemma that the reference data, possibly like others, uses reference sequence ID (rsid) whenever possible. However, during meta-analysis the practice of using rsids is undesirable so SNPID, i.e., chr:pos_A1_A2, (A1<=A2) is necessary. After a rather long and laborious process involving many software, it turned out a simple way out is to obtain sentinels using SNPID but return to rsids at this stage and forward. The implementation here reflects this. The file INTERVAL.rsid contains SNPID-rsid mapping and could be generated from programs such as qctool/bgenix/plink . A related file is snp_pos containing rsid -- chr:pos mappings; for instance this could be built from dbSNP. A note on regions is ready. It is attractive to use the last genomic region from iterative merging for analysis and perhaps a flanking version. This is more appropriate than genome-wide hard and fast 10MB windows or approximately independent LD blocks. For the latter, we found that the boundaries from the distributed 1000Genomes project were often inappropriate and one may not attempt to compute them for specific reference panel. Nevertheless, the iterative procedure actually just does empirically. Again the HLA region is condensed. The last point regards software finemap , which uses summary statistics associated with the reference panel rather than that from meta-analysis. File Description NLRP2.sh the exclusion list cs.sh Credible sets ma.sh INF1 sumstats INTERVAL-ma.sh INTERVAL sumstats prune.sh pruning slct.sh GCTA --cojo-slct analysis finemap.sh finemap analysis jam.sh JAM analysis st.sh batch command file cs/, finemap/, jam/, prune/, work/ working directories Steps st.sh conceptually executes the following elements, graph TB sumstats(\"sumstats from METAL\") --> |\"variants from prune.sh\"| slct.sh utils.sh(\"INTERVAL sumstats from standardized residuals ~ genotypes\") --> |\"variants from prune.sh\"| cs.sh utils.sh --> |\"internal prune\" | jam.sh utils.sh --> |\"--n-causal-snps k\"| finemap.sh Note that the GCTA .ma, jma.cojo, .ldr.cojo become -rsid.ma, -rsid.jma.cojo, -rsid.ldr.cojo, respectively; the same are true for files related to finemap . Variant annotation This is exemplified with vep.sh . GARFIELD analysis is furnsihed with garfield.sh . Specific and collective enrichment can be found in magma.sh and rGREAT.sh . Known pQTLs Program cvd1.sh was used to obtain SCALLOP-CVD1 summary statistics. pQTL.R was used for QTL lookup. Colocalization analysis eQTL lookup is done with PhenoScanner via eQTL.R , eQTLGen.sh and GTEx via GTEx-ps.R , GTEx-ps.sh and GTEx-ps-jma.sh . Credible set lookup from GTEx v8 is furnished with GTEx-cs.sh and GTEx-cs-jma.sh . Eearlier experiments were done with coloc.sb (clumsy) and coloc.R (with pQTLtools) as well as fastenloc.sb . Multitrait counterparts were also done with HyPrColoc as in rs12075.sh and LTBR.sh (stack_assoc_plot + HyPrColoc/PWCoCo) and LTBR.sh contains a routine to generate tabix-indexed blood cell traits. Stacked association plots were done with IL.18-rs385076.sh and OPG-TRANCE.sh . Mendelian Randomization There has been a major overhaul by refocusing on cis-pQTLs using GSMR involving both immune-mediated traits and COVID outcomes. These have been implemented in mr.sh and mr.sb . To get around the mishap with rsids we switched back to SNPids; we found the options --clump-r2 0.1 --gsmr-snp-min 10 make more sense for instance with IL-12B it would retain the sentinel and also the significant MR results on inflammatory bowel disease. Earlier we coded specifically for HGI analysis, in particular aiming for four test statistics and better quality graphics. It turned to be more efficient in cis-pQTL analyses to extract the relevant variants involving in the analysis, rather than using whole-genome reference files. This led to ref/, prot/, /trait directories for reference, protein and trait data, respectively. The GSMR implementation started with CAD/FEV1 (now with gsmr.sh , gsmr.sb , gsmr.R ) and then HGI as gsmr_HGI.* and pQTLMR/MR ( HGI.sh , HGI.R ), and +/- 1MB ( rs635634.sh ). Earlier on, a pQTL-based MR analysis is furnished with pqtlMR.sh . Immune-mediatd traits from OpenGWAS is obtained via OpenGWAS.sh . pqtlGWAS.R was used for pQTL-GWAS lookup. Nested PGS model Without loss of generality, we have genotype data G, which link with proteins P1, P2, P3 as predictors for outcome y. The figure is obtained with dot -Tpng grViz.gv -ogrViz.png which also be obtained from RStudio for somewhat larger size. File fusion_twas.sb initiated a FUSION TWAS experiment. Summary statistics This is implemented with gwasvcf.sh and gwas2vcf.sb which includes some operations on VCF files. However, we found there is loss of information if enforcing use of RSid. Mathematical expressions We first make some preparations. Let \\(\\mbox{x} = SNP\\ dosage\\) . Note that \\(\\mbox{Var}(\\mbox{x})=2f(1-f)\\) , \\(f=MAF\\) or \\(1-MAF\\) by symmetry. Our linear regression model is \\(\\mbox{y}=a + b\\mbox{x} + e\\) . We have \\(\\mbox{Var}(\\mbox{y}) = b^2\\mbox{Var}(\\mbox{x}) + \\mbox{Var}(e)\\) . Moreover, \\(\\mbox{Var}(b)=\\mbox{Var}(e)/S_\\mbox{xx}\\) , we have \\(\\mbox{Var}(e) = \\mbox{Var}(b)S_\\mbox{xx} = N \\mbox{Var}(b) \\mbox{Var}(\\mbox{x})\\) . Moreover, the mean and variance of the multiple correlation coefficient or the coefficient of determination ( \\(R^2\\) ) are known to be \\(\\frac{1}{N-1}\\) and \\(\\frac{2(N-2)}{(N-1)^2(N+1)}\\) , respectively. We also need some established results of a ratio (R/S), i.e., the mean \\[ \\begin{align} E(R/S) \\approx \\frac{\\mu_R}{\\mu_S}-\\frac{\\mbox{Cov}(R,S)}{\\mu_S^2}+\\frac{\\sigma_S^2\\mu_R}{\\mu_S^3} \\hspace{100cm} \\end{align} \\] and more importantly the variance \\[ \\begin{align} \\mbox{Var}(R/S) \\approx \\frac{\\mu_R^2}{\\mu_S^2} \\left[ \\frac{\\sigma_R^2}{\\mu_R^2} -2\\frac{\\mbox{Cov}(R,S)}{\\mu_R\\;\\mu_S} +\\frac{\\sigma_S^2}{\\mu_S^2} \\right] \\hspace{100cm} \\end{align} \\] where \\(\\mu_R\\) , \\(\\mu_S\\) , \\(\\sigma_R^2\\) , \\(\\sigma_S^2\\) are the means and the variances for R and S, respectively. Finally, we need some facts about \\(\\chi_1^2\\) , \\(\\chi^2\\) distribution of one degree of freedom. For \\(z \\sim N(0,1)\\) , \\(z^2\\sim \\chi_1^2\\) , whose mean and variance are 1 and 2, respectively. We now have results 1 and 2 below followed by others. The proportion of variants explained (PVE). From above \\(PVE = {\\mbox{Var}(b\\mbox{x})}/{\\mbox{Var}(\\mbox{y})} = {2f(1-f)b^2}/{[2f(1-f)b^2+2Nf(1-f)\\mbox{Var}(b)]}\\) . In fact, let \\(z = {b}/{SE(b)}\\) , \\(PVE = {\\mbox{z}^2}/{(\\mbox{z}^2+N)}\\) . On the other hand, for a simple linear regression \\(R^2\\equiv r^2\\) where \\(r\\) is the Pearson correlation coefficient, which is readily from the \\(t\\) -statistic of the regression slope, i.e., \\(r={t}/{\\sqrt{t^2+N-2}}\\) . so assuming \\(t \\equiv \\ z \\sim \\chi_1^2\\) PVE = \\(\\frac{\\chi^2}{\\chi^2+N-2}\\) To obtain a coherent estimates of the asymptotic means and variances of both forms we resort to variance of a ratio (R/S). All the required elements are listed in a table below. Linear regression \\(t\\) -statistic \\(\\mu_R=1\\) \\(\\mu_R=1\\) \\(\\sigma_R^2=2\\) \\(\\sigma_R^2=2\\) \\(\\mu_S=N+1\\) \\(\\mu_S=N-1\\) \\(\\sigma_S^2=2\\) \\(\\sigma_S^2=2\\) \\(\\mbox{Cov}(R,S)=2\\) \\(\\mbox{Cov}(R,S)=2\\) then we have Characteristics Linear regression \\(t\\) -statistic mean \\(\\frac{1}{N+1}\\left[1-\\frac{2}{N+1}+\\frac{2}{(N+1)^2}\\right]\\) \\(\\frac{1}{N-1}\\left[1-\\frac{2}{N-1}+\\frac{2}{(N-1)^2}\\right]\\) variance \\(\\frac{2}{(N+1)^2}\\left[1-\\frac{1}{N+1}\\right]^2\\) \\(\\frac{2}{(N-1)^2}\\left[1-\\frac{1}{N-1}\\right]^2\\) For \\(T\\) independent pQTLs of a protein from meta-analytic statistics PVE is approximated with PVE = \\(\\sum_{i=1}^T{\\frac{\\chi_i^2}{\\chi_i^2+N_i}}\\) or \\(\\sum_{i=1}^T{\\frac{\\chi_i^2}{\\chi_i^2+N_i-2}}\\) and their variances are approximately \\(\\sum_{i=1}^T\\frac{2}{(N_i+1)^2}\\) and \\(\\sum_{i=1}^T\\frac{2}{(N_i-1)^2}\\) , respectively. Seeing that \\(\\mbox{Var}(\\mbox{y})=\\mbox{Var}(\\mbox{x})(b^2+N\\mbox{Var}(b))=\\mbox{Var}(\\mbox{x})\\mbox{Var}(\\mbox{b})(z^2+N)=2f(1-f)(z^2+N)\\mbox{Var}(b)\\) . When \\(\\mbox{Var}(\\mbox{y})=1\\) , as in cis eQTLGen data, we have \\(b\\) and its standard error (se) as follows, \\[ \\begin{align} b & = z/d \\hspace{100cm} \\\\ se & = 1/d \\end{align} \\] where \\(d = \\sqrt{2f(1-f)(z^2+N)}\\) . The prior probability for \\(i\\) out of \\(m\\) variants is causal, is obtained as a binomial probability \\(p(i)={m\\choose{i}}{\\left(\\frac{i}{m}\\right)^i\\left(1-\\frac{i}{m}\\right)^{m-i}}\\) The posterior number of causal signals in the genomic region is obtained as the expectation \\(\\sum_i\u2009p(i|\\mbox{data})\u2009\\times\u2009i\\) . The search of total number of configurations \\(\\sum_{i=1}^k{m\\choose{i}}\\) The GREAT Binomial test is \\(\\sum_{i=k_\\pi}^n{n\\choose{i}}p_\\pi^i(1-p_\\pi)^{n-i}\\) A proteome-wide analogy \\(z_{PWAS}\\) is made to (transcriptome)wide association statistic originally proposed for gene expression data. For a given Protein of interest P for which GWAS summary statistics \\(z_P\\) is available, the corresponding Wald statistic for PWAS is defined such that \\(z_{PWAS} = \\frac{w^T_{P}z_P}{\\sqrt{w^T_{P}Vw_{P}}}\\) where \\(w_{P}\\) is a weight associated with protein abundance level and V covariance matrix for \\(z_P\\) , respectively. SomaLogic overlap The overlap is characterised with Olink.R which also gives a Venn diagram. UniProt IDs The list of proteins on inflammation is within one of the Olink panels (as in Olink validation data all panels.xlsx ) each containing 92 proteins. Information contained in these panels can be retrieved into R via Olink.R , which also attempts to compromise earlier version and annotations. Nevertheless O43508 is replaced with Q4ACW9 for TWEAK. BDNF has recently been removed from the assay and replaced with CD8A, https://www.olink.com/bdnf-info/ , and there are also changes on TNF and IFN.gamma, https://www.olink.com/inflammation-upgrade/ . A UniProt ID may be associated with multiple chromosomes, e.g., Q6IEY1 with chromosomes 1 and 5. While inf1.csv edits Q4ACW9, inf2.csv is inline with UCSC with respect to P12034 and P30203. The use of uniprot IDs is noted in two aspects, The protein list in inf1.csv notes both O43508 and Q4ACW9. Q8NF90 and Q8WWJ7 were not listed at the UCSC, their availability on UniProt seem to be for backward compatibility as on query they point to P12034 and P30203 (Q8WWJ7_HUMAN should have been CD6_HUMAN). hgTables.tsv is based on UCSC, checked over UniProt IDs as follows, grep inf1 doc/olink.prot.list.txt | \\ sed 's/inf1_//g;s/___/\\t/g' > inf1.list join -t$'\\t' -12 -24 \\ <(sort -k2,2 inf1.list) \\ <(awk '{split($4,f,\"-\"); $4=f[1]; if(!index($1,\"_\")) print}' OFS='\\t' doc/hgTables.tsv | sort -k4,4) \\ > 12 # 90 lines wc -l 12 # Q8NF90 (FGF.5), Q8WWJ7 (CD6) are missing join -v2 -22 12 <(sort -k2,2 inf1.list) rm 12 Likewise, olink.inf.panel.annot.tsv from olink.annotation.R also has the following two entries \"target\" \"target.short\" \"uniprot\" \"panel\" \"prot.on.multiple.panel\" \"panels.with.prot\" \"hgnc_symbol\" ... \"Fibroblast growth factor 5 (FGF-5)\" \"FGF-5\" \"Q8NF90\" \"inf\" FALSE NA NA \"T-cell surface glycoprotein CD6 isoform (CD6)\" \"CD6\" \"Q8WWJ7\" \"inf\" FALSE NA NA whose hgnc_symbol can be amended. Auxiliary files The following table lists various other aspects not documented above; many can be seen as a skeleton for further work. File Description chembl.sh toy CHEMBL queries CRP.sh an inflammation score circos.* circos/circlize scripts efo.R experimental factor ontology epigraphdb-pleiotropy.R horizontal and vertical pleiotropy epigraphdb-ppi.R PPI using EpiGraphDB gdigt.R GDI and gene-trials GREP.sh GREP script h2pve.* h2/pve summary inbio-discover.R gene lists pheweb.Rmd Data extraction from pheweb.jp qqman.sb Q-Q/Manhattan plots under CSD3 rentrez.sh reuse of rentrez Somascan-Olink.* Somascan/Olink overlap stringdb.sh STRINGdb tables.R code to create Excel Tables uniprot.R UniProt IDs to others utils.sh utilties wgcna.sh experiment on modules Date last changed: 11/11/2021","title":"Supplementary notes"},{"location":"rsid/#supplementary-notes","text":"This page was initiated with conditional analysis and fine-mapping, and now expanded with many other threads of the analysis.","title":"Supplementary notes"},{"location":"rsid/#signal-selection","text":"This is illustrated with neale.sh for Neale UKB data (HbA1c).","title":"Signal selection"},{"location":"rsid/#conditional-analysis-and-fine-mapping","text":"The INTERVAL data is used as reference panel. The logic of this specific directory is a simple solution of the dilemma that the reference data, possibly like others, uses reference sequence ID (rsid) whenever possible. However, during meta-analysis the practice of using rsids is undesirable so SNPID, i.e., chr:pos_A1_A2, (A1<=A2) is necessary. After a rather long and laborious process involving many software, it turned out a simple way out is to obtain sentinels using SNPID but return to rsids at this stage and forward. The implementation here reflects this. The file INTERVAL.rsid contains SNPID-rsid mapping and could be generated from programs such as qctool/bgenix/plink . A related file is snp_pos containing rsid -- chr:pos mappings; for instance this could be built from dbSNP. A note on regions is ready. It is attractive to use the last genomic region from iterative merging for analysis and perhaps a flanking version. This is more appropriate than genome-wide hard and fast 10MB windows or approximately independent LD blocks. For the latter, we found that the boundaries from the distributed 1000Genomes project were often inappropriate and one may not attempt to compute them for specific reference panel. Nevertheless, the iterative procedure actually just does empirically. Again the HLA region is condensed. The last point regards software finemap , which uses summary statistics associated with the reference panel rather than that from meta-analysis. File Description NLRP2.sh the exclusion list cs.sh Credible sets ma.sh INF1 sumstats INTERVAL-ma.sh INTERVAL sumstats prune.sh pruning slct.sh GCTA --cojo-slct analysis finemap.sh finemap analysis jam.sh JAM analysis st.sh batch command file cs/, finemap/, jam/, prune/, work/ working directories Steps st.sh conceptually executes the following elements, graph TB sumstats(\"sumstats from METAL\") --> |\"variants from prune.sh\"| slct.sh utils.sh(\"INTERVAL sumstats from standardized residuals ~ genotypes\") --> |\"variants from prune.sh\"| cs.sh utils.sh --> |\"internal prune\" | jam.sh utils.sh --> |\"--n-causal-snps k\"| finemap.sh Note that the GCTA .ma, jma.cojo, .ldr.cojo become -rsid.ma, -rsid.jma.cojo, -rsid.ldr.cojo, respectively; the same are true for files related to finemap .","title":"Conditional analysis and fine-mapping"},{"location":"rsid/#variant-annotation","text":"This is exemplified with vep.sh . GARFIELD analysis is furnsihed with garfield.sh . Specific and collective enrichment can be found in magma.sh and rGREAT.sh .","title":"Variant annotation"},{"location":"rsid/#known-pqtls","text":"Program cvd1.sh was used to obtain SCALLOP-CVD1 summary statistics. pQTL.R was used for QTL lookup.","title":"Known pQTLs"},{"location":"rsid/#colocalization-analysis","text":"eQTL lookup is done with PhenoScanner via eQTL.R , eQTLGen.sh and GTEx via GTEx-ps.R , GTEx-ps.sh and GTEx-ps-jma.sh . Credible set lookup from GTEx v8 is furnished with GTEx-cs.sh and GTEx-cs-jma.sh . Eearlier experiments were done with coloc.sb (clumsy) and coloc.R (with pQTLtools) as well as fastenloc.sb . Multitrait counterparts were also done with HyPrColoc as in rs12075.sh and LTBR.sh (stack_assoc_plot + HyPrColoc/PWCoCo) and LTBR.sh contains a routine to generate tabix-indexed blood cell traits. Stacked association plots were done with IL.18-rs385076.sh and OPG-TRANCE.sh .","title":"Colocalization analysis"},{"location":"rsid/#mendelian-randomization","text":"There has been a major overhaul by refocusing on cis-pQTLs using GSMR involving both immune-mediated traits and COVID outcomes. These have been implemented in mr.sh and mr.sb . To get around the mishap with rsids we switched back to SNPids; we found the options --clump-r2 0.1 --gsmr-snp-min 10 make more sense for instance with IL-12B it would retain the sentinel and also the significant MR results on inflammatory bowel disease. Earlier we coded specifically for HGI analysis, in particular aiming for four test statistics and better quality graphics. It turned to be more efficient in cis-pQTL analyses to extract the relevant variants involving in the analysis, rather than using whole-genome reference files. This led to ref/, prot/, /trait directories for reference, protein and trait data, respectively. The GSMR implementation started with CAD/FEV1 (now with gsmr.sh , gsmr.sb , gsmr.R ) and then HGI as gsmr_HGI.* and pQTLMR/MR ( HGI.sh , HGI.R ), and +/- 1MB ( rs635634.sh ). Earlier on, a pQTL-based MR analysis is furnished with pqtlMR.sh . Immune-mediatd traits from OpenGWAS is obtained via OpenGWAS.sh . pqtlGWAS.R was used for pQTL-GWAS lookup.","title":"Mendelian Randomization"},{"location":"rsid/#nested-pgs-model","text":"Without loss of generality, we have genotype data G, which link with proteins P1, P2, P3 as predictors for outcome y. The figure is obtained with dot -Tpng grViz.gv -ogrViz.png which also be obtained from RStudio for somewhat larger size. File fusion_twas.sb initiated a FUSION TWAS experiment.","title":"Nested PGS model"},{"location":"rsid/#summary-statistics","text":"This is implemented with gwasvcf.sh and gwas2vcf.sb which includes some operations on VCF files. However, we found there is loss of information if enforcing use of RSid.","title":"Summary statistics"},{"location":"rsid/#mathematical-expressions","text":"We first make some preparations. Let \\(\\mbox{x} = SNP\\ dosage\\) . Note that \\(\\mbox{Var}(\\mbox{x})=2f(1-f)\\) , \\(f=MAF\\) or \\(1-MAF\\) by symmetry. Our linear regression model is \\(\\mbox{y}=a + b\\mbox{x} + e\\) . We have \\(\\mbox{Var}(\\mbox{y}) = b^2\\mbox{Var}(\\mbox{x}) + \\mbox{Var}(e)\\) . Moreover, \\(\\mbox{Var}(b)=\\mbox{Var}(e)/S_\\mbox{xx}\\) , we have \\(\\mbox{Var}(e) = \\mbox{Var}(b)S_\\mbox{xx} = N \\mbox{Var}(b) \\mbox{Var}(\\mbox{x})\\) . Moreover, the mean and variance of the multiple correlation coefficient or the coefficient of determination ( \\(R^2\\) ) are known to be \\(\\frac{1}{N-1}\\) and \\(\\frac{2(N-2)}{(N-1)^2(N+1)}\\) , respectively. We also need some established results of a ratio (R/S), i.e., the mean \\[ \\begin{align} E(R/S) \\approx \\frac{\\mu_R}{\\mu_S}-\\frac{\\mbox{Cov}(R,S)}{\\mu_S^2}+\\frac{\\sigma_S^2\\mu_R}{\\mu_S^3} \\hspace{100cm} \\end{align} \\] and more importantly the variance \\[ \\begin{align} \\mbox{Var}(R/S) \\approx \\frac{\\mu_R^2}{\\mu_S^2} \\left[ \\frac{\\sigma_R^2}{\\mu_R^2} -2\\frac{\\mbox{Cov}(R,S)}{\\mu_R\\;\\mu_S} +\\frac{\\sigma_S^2}{\\mu_S^2} \\right] \\hspace{100cm} \\end{align} \\] where \\(\\mu_R\\) , \\(\\mu_S\\) , \\(\\sigma_R^2\\) , \\(\\sigma_S^2\\) are the means and the variances for R and S, respectively. Finally, we need some facts about \\(\\chi_1^2\\) , \\(\\chi^2\\) distribution of one degree of freedom. For \\(z \\sim N(0,1)\\) , \\(z^2\\sim \\chi_1^2\\) , whose mean and variance are 1 and 2, respectively. We now have results 1 and 2 below followed by others. The proportion of variants explained (PVE). From above \\(PVE = {\\mbox{Var}(b\\mbox{x})}/{\\mbox{Var}(\\mbox{y})} = {2f(1-f)b^2}/{[2f(1-f)b^2+2Nf(1-f)\\mbox{Var}(b)]}\\) . In fact, let \\(z = {b}/{SE(b)}\\) , \\(PVE = {\\mbox{z}^2}/{(\\mbox{z}^2+N)}\\) . On the other hand, for a simple linear regression \\(R^2\\equiv r^2\\) where \\(r\\) is the Pearson correlation coefficient, which is readily from the \\(t\\) -statistic of the regression slope, i.e., \\(r={t}/{\\sqrt{t^2+N-2}}\\) . so assuming \\(t \\equiv \\ z \\sim \\chi_1^2\\) PVE = \\(\\frac{\\chi^2}{\\chi^2+N-2}\\) To obtain a coherent estimates of the asymptotic means and variances of both forms we resort to variance of a ratio (R/S). All the required elements are listed in a table below. Linear regression \\(t\\) -statistic \\(\\mu_R=1\\) \\(\\mu_R=1\\) \\(\\sigma_R^2=2\\) \\(\\sigma_R^2=2\\) \\(\\mu_S=N+1\\) \\(\\mu_S=N-1\\) \\(\\sigma_S^2=2\\) \\(\\sigma_S^2=2\\) \\(\\mbox{Cov}(R,S)=2\\) \\(\\mbox{Cov}(R,S)=2\\) then we have Characteristics Linear regression \\(t\\) -statistic mean \\(\\frac{1}{N+1}\\left[1-\\frac{2}{N+1}+\\frac{2}{(N+1)^2}\\right]\\) \\(\\frac{1}{N-1}\\left[1-\\frac{2}{N-1}+\\frac{2}{(N-1)^2}\\right]\\) variance \\(\\frac{2}{(N+1)^2}\\left[1-\\frac{1}{N+1}\\right]^2\\) \\(\\frac{2}{(N-1)^2}\\left[1-\\frac{1}{N-1}\\right]^2\\) For \\(T\\) independent pQTLs of a protein from meta-analytic statistics PVE is approximated with PVE = \\(\\sum_{i=1}^T{\\frac{\\chi_i^2}{\\chi_i^2+N_i}}\\) or \\(\\sum_{i=1}^T{\\frac{\\chi_i^2}{\\chi_i^2+N_i-2}}\\) and their variances are approximately \\(\\sum_{i=1}^T\\frac{2}{(N_i+1)^2}\\) and \\(\\sum_{i=1}^T\\frac{2}{(N_i-1)^2}\\) , respectively. Seeing that \\(\\mbox{Var}(\\mbox{y})=\\mbox{Var}(\\mbox{x})(b^2+N\\mbox{Var}(b))=\\mbox{Var}(\\mbox{x})\\mbox{Var}(\\mbox{b})(z^2+N)=2f(1-f)(z^2+N)\\mbox{Var}(b)\\) . When \\(\\mbox{Var}(\\mbox{y})=1\\) , as in cis eQTLGen data, we have \\(b\\) and its standard error (se) as follows, \\[ \\begin{align} b & = z/d \\hspace{100cm} \\\\ se & = 1/d \\end{align} \\] where \\(d = \\sqrt{2f(1-f)(z^2+N)}\\) . The prior probability for \\(i\\) out of \\(m\\) variants is causal, is obtained as a binomial probability \\(p(i)={m\\choose{i}}{\\left(\\frac{i}{m}\\right)^i\\left(1-\\frac{i}{m}\\right)^{m-i}}\\) The posterior number of causal signals in the genomic region is obtained as the expectation \\(\\sum_i\u2009p(i|\\mbox{data})\u2009\\times\u2009i\\) . The search of total number of configurations \\(\\sum_{i=1}^k{m\\choose{i}}\\) The GREAT Binomial test is \\(\\sum_{i=k_\\pi}^n{n\\choose{i}}p_\\pi^i(1-p_\\pi)^{n-i}\\) A proteome-wide analogy \\(z_{PWAS}\\) is made to (transcriptome)wide association statistic originally proposed for gene expression data. For a given Protein of interest P for which GWAS summary statistics \\(z_P\\) is available, the corresponding Wald statistic for PWAS is defined such that \\(z_{PWAS} = \\frac{w^T_{P}z_P}{\\sqrt{w^T_{P}Vw_{P}}}\\) where \\(w_{P}\\) is a weight associated with protein abundance level and V covariance matrix for \\(z_P\\) , respectively.","title":"Mathematical expressions"},{"location":"rsid/#somalogic-overlap","text":"The overlap is characterised with Olink.R which also gives a Venn diagram.","title":"SomaLogic overlap"},{"location":"rsid/#uniprot-ids","text":"The list of proteins on inflammation is within one of the Olink panels (as in Olink validation data all panels.xlsx ) each containing 92 proteins. Information contained in these panels can be retrieved into R via Olink.R , which also attempts to compromise earlier version and annotations. Nevertheless O43508 is replaced with Q4ACW9 for TWEAK. BDNF has recently been removed from the assay and replaced with CD8A, https://www.olink.com/bdnf-info/ , and there are also changes on TNF and IFN.gamma, https://www.olink.com/inflammation-upgrade/ . A UniProt ID may be associated with multiple chromosomes, e.g., Q6IEY1 with chromosomes 1 and 5. While inf1.csv edits Q4ACW9, inf2.csv is inline with UCSC with respect to P12034 and P30203. The use of uniprot IDs is noted in two aspects, The protein list in inf1.csv notes both O43508 and Q4ACW9. Q8NF90 and Q8WWJ7 were not listed at the UCSC, their availability on UniProt seem to be for backward compatibility as on query they point to P12034 and P30203 (Q8WWJ7_HUMAN should have been CD6_HUMAN). hgTables.tsv is based on UCSC, checked over UniProt IDs as follows, grep inf1 doc/olink.prot.list.txt | \\ sed 's/inf1_//g;s/___/\\t/g' > inf1.list join -t$'\\t' -12 -24 \\ <(sort -k2,2 inf1.list) \\ <(awk '{split($4,f,\"-\"); $4=f[1]; if(!index($1,\"_\")) print}' OFS='\\t' doc/hgTables.tsv | sort -k4,4) \\ > 12 # 90 lines wc -l 12 # Q8NF90 (FGF.5), Q8WWJ7 (CD6) are missing join -v2 -22 12 <(sort -k2,2 inf1.list) rm 12 Likewise, olink.inf.panel.annot.tsv from olink.annotation.R also has the following two entries \"target\" \"target.short\" \"uniprot\" \"panel\" \"prot.on.multiple.panel\" \"panels.with.prot\" \"hgnc_symbol\" ... \"Fibroblast growth factor 5 (FGF-5)\" \"FGF-5\" \"Q8NF90\" \"inf\" FALSE NA NA \"T-cell surface glycoprotein CD6 isoform (CD6)\" \"CD6\" \"Q8WWJ7\" \"inf\" FALSE NA NA whose hgnc_symbol can be amended.","title":"UniProt IDs"},{"location":"rsid/#auxiliary-files","text":"The following table lists various other aspects not documented above; many can be seen as a skeleton for further work. File Description chembl.sh toy CHEMBL queries CRP.sh an inflammation score circos.* circos/circlize scripts efo.R experimental factor ontology epigraphdb-pleiotropy.R horizontal and vertical pleiotropy epigraphdb-ppi.R PPI using EpiGraphDB gdigt.R GDI and gene-trials GREP.sh GREP script h2pve.* h2/pve summary inbio-discover.R gene lists pheweb.Rmd Data extraction from pheweb.jp qqman.sb Q-Q/Manhattan plots under CSD3 rentrez.sh reuse of rentrez Somascan-Olink.* Somascan/Olink overlap stringdb.sh STRINGdb tables.R code to create Excel Tables uniprot.R UniProt IDs to others utils.sh utilties wgcna.sh experiment on modules Date last changed: 11/11/2021","title":"Auxiliary files"},{"location":"tryggve/","text":"Tryggve Tryggve is the server used for SCALLOP and also SCALLOP-INF at earlier stage of the analysis. The document covers various aspects such as software and data. Modules Instances are exemplified as follows, module load anaconda2/4.4.0 module load bedtools/2.28.0 module load bgen/20180807 module load perl/5.24.0 annovar/2019oct24 module load bcftools/1.9 module load emacs/26.1 module load gcta/1.91.0beta module load intel/redist/2019 intel/perflibs/64/2019 gcc/5.4.0 lapack/3.8.0 R/3.5.3-ICC-MKL rstudio/1.1.453 module load libreoffice/6.0.5.2 module load locuszoom/1.4 module load metal/20180828 module load pandoc/2.1 module load parallel/20190122 module load plink2/1.90beta5.4 module load vcftools/0.1.16 module load xpdf/3.04 export threads=1 e.g., pandoc tryggve.md -o tryggve.docx soffice tryggve.docx xterm -fa arial -fs 12 -bg black -fg white Parallel computing METAL.qsub was intended to run batch jobs under Terascale Open-source Resource and QUEue Manager (TORQUE) controls batch jobs and distributed compute nodes, enabling integration with Moab cluster suite and extending Portable Batch System (PBS) with respect to extend scalability, fault tolerance, and functionality. Information on job scheduling on Computerome is availble from https://www.computerome.dk/display/CW/Batch+System, However, the SCALLOP securitycloud is a 1-node cloud and we resort to parallel instead, e.g, module load metal/20110325 parallel/20190122 ls METAL/*.run | parallel --dry-run --env HOME -j8 -C' ' 'metal $HOME/INF/{}' NB METAL add -1 to the filenames. SOFTWARE ISSUES Bash functions There might be problems with R/3.5.3-ICC-MKL so functions are defined in .bashrc which can be invoked at the start of a session, then one invokes R.3.5.3 when necessary. # This could be very slow function R.3.5.3() { export R_LIBS=/data/$USER/R:/services/tools/R/3.5.3-ICC-MKL/lib64/R/library module load intel/redist/2019 intel/perflibs/64/2019 gcc/5.4.0 lapack/3.8.0 R/3.5.3-ICC-MKL lapack/3.8.0 source /data/jinhua/parallel-20190222/bin/env_parallel.bash alias R='/services/tools/R/3.5.3-ICC-MKL/bin/R -q $@' } # An alternative function R.3.3.1() { module load intel/redist/2019 intel/perflibs/64/2019 gcc/5.4.0 R/3.3.1-ICC-MKL } We also use R 3.3.x below. Code extraction This is possible with codedown, as noted here . LocusZoom 1.4 To use LocusZoom 1.4, one only needs to start with module load gcc/5.4.0 module load R/3.2.5 module load anaconda2/4.4.0 module load locuszoom/1.4 finemap/ldstore finemap 1.3.1 and ldstore 1.1 are available from /data/jinhua and can be enabled as follows, ln -fs /data/jinhua/ldstore_v1.1_x86_64/ldstore $HOME/bin/ldstore_v1.1 ln -fs /data/jinhua/finemap_v1.3.1_x86_64/finemap_v1.3.1_x86_64 $HOME/bin/finemap_v1.3.1 ```` finemap 1.4 and ldstore 2.0b are available from /data/jinhua/finemap-1.4. ### qctool TRYGGVE now fixed issue with qctool/2.0.1 for lack of lapack shared libraries as in /data/jinhua/lapack-3.8.0/ and its installation described on GitHub repository, https://github.com/jinghuazhao/Computational-Statistics. It is then possible to issue `module load gcc/5.4.0 lapack/3.8.0 qctool/2.0.1`. ## NEW SOFTWARE There are a number of software updates/additions which are worthy of note. ### GCTA A more recenve version is available from /data/jinhua/gcta_1.91.7beta/. This version can handle chi-squared statistics instead of p values in the joint/conditional (COJO) analysis; it also allows for `--grm file --pca --out file`, i.e., same file root. ### GNU parallel The latest version parallel-20190222 has new features and use them directly on TRYGGVE without invoking modules as follows, ```bash export src=/data/jinhua/parallel-20190222/bin for i in $(ls $src); do ln -fs $src/$i $HOME/bin/$i; done export MANPATH=/data/jinhua/parallel-20190222/share/man:$MANPATH The last line enables man parallel and info parallel . ImageMagick This is version 7.0.8-22, made available due to the inability to use the imagemagick/7.0.8-16 module, e.g., export PATH=/data/jinhua/ImageMagick-7.0.8-22/bin:$PATH convert OPG.lz-1.png -resize 130% OPG.lz-3.png convert \\( OPG.qq.png -append OPG.manhattan.png -append OPG.lz-3.png -append \\) +append OPG-qml.png used to generate the figure in the front page. Another very useful utility is its display . METAL The version as in /data/jinhua/METAL-2018-08-28 contains modification which allows for CUSTOMVARIABLE to use integer position rather than scientific format as in software-notes . An extension was made with the Direction column so that if a variant with '+' and '-' effects becomes 'p' and 'n', respectively with P <= 0.05. To avoid loading the default /usr/bin/metal, one can add ln -sf /data/jinhua/METAL-2018-08-28/metal $HOME/bin/metal export PATH=$HOME/bin:/data/jinhua/ImageMagick-7.0.8-22/bin:$PATH into $HOME/.bashrc. OpenVPN In case you see message \"All TAP-Windows aapters on this system are currently in use\", read this post , esp. install tap-windows-8.21.2 . The log is usually located at \"%USERPROFILE%/OpenVPN/log\". R EasyQC/EasyStrata The version is 18.1 rather than 9.2 and 8.6 currently online, https://www.uni-regensburg.de/medizin/epidemiologie-praeventivmedizin/genetische-epidemiologie/software/. gap First, run R.3.5.3 as defined above. This version contains functions cis.vs.trans.classification, gc.lambda, invnormal, and here is the way to go module load intel/redist/2019 intel/perflibs/64/2019 gcc/5.4.0 R/3.5.3-ICC-MKL tar xvfz gap_1.2.2.tar.gz cd gap/src gcc -I/services/tools/intel/perflibs/2019/compilers_and_libraries/linux/mpi/intel64/include -L/services/tools/intel/perflibs/2019/compilers_and_libraries/linux/mpi/intel64/lib/release -L/services/tools/intel/perflibs/2019/compilers_and_libraries/linux/mpi/intel64/lib -Xlinker --enable-new-dtags -Xlinker -rpath -Xlinker /services/tools/intel/perflibs/2019/compilers_and_libraries/linux/mpi/intel64/lib/release -Xlinker -rpath -Xlinker /services/tools/intel/perflibs/2019/compilers_and_libraries/linux/mpi/intel64/lib -Xlinker -rpath -Xlinker /opt/intel/mpi-rt/2017.0.0/intel64/lib/release -Xlinker -rpath -Xlinker /opt/intel/mpi-rt/2017.0.0/intel64/lib -lmpifort -lmpi -ldl -lrt -lpthread -L/services/tools/intel/perflibs/2019//compilers_and_libraries_2019.0.117/linux/mpi/intel64/libfabric/lib -fPIC -c *.c *.f gcc -shared -L/services/tools/R/3.5.3-ICC-MKL/lib64/R/lib -L/usr/local/lib64 -o gap.so 2k.o 2ld.o cline.o gcontrol_c.o gcx.o gif_c.o hap_c.o hwe.hardy.o kin.morgan.o makeped_c.o mia.o muvar.o package_native_routine_registration_skeleton.o pfc.o pfc.sim.o pgc_c.o whscore.o -L/usr/lib/gcc/x86_64-redhat-linux/4.8.2 -lgfortran -lm -lquadmath -L/services/tools/R/3.5.3-ICC-MKL/lib64/R/lib -lR cd - R CMD INSTALL gap -l /data/jinhua/R The rather imtimidating compiler flags are derived from mpiicc -show as with initial pass requested for libfabric.so.1, and the idea is to get around check for icc which does not exist on the system. To faciliate compiling, gap.sh contains these lines for use. To take advantage of the circos.mhtplot function, package R/gap.datasets is also made available. The following is an example for cross-check, R --no-save -q <<END gz <- \"sumstats/STABILITY/STABILITY.IFN.gamma.gz\" STABILITY <- read.table(gz,as.is=TRUE,header=TRUE,sep=\"\\t\") summary(STABILITY) library(\"GenABEL\") estlambda(with(STABILITY,PVAL), method=\"median\") END Somehow R/gap thus compiled was very slow; so attempt was also made with R 3.3.1 via gap.3.3.1.sh which requires registration of routine family (defined in pfc.f ) altered to family_ and the change is made as default. The fp() function in analysis.sh requires R.3.3.1 to be called. QCGWAS The version contains fix to the use of HapMap reference as in software-notes above. The HapMap data as with code from the packages's quick guide is /data/jinhua/data/QCGWAS. A SUMMARY OF FILES File specification Descrription doc/ Oringal documents -- KORA.prot.preproc.belowlod.v2.R* R code for data preprocessing -- kora.normalised.prot.txt* sex, age, normalised proteins -- KORA.pc.below.llod.pdf* llod check METAL/ METAL/output scripts by protein sumstats/ File lists and study directories tryggve/ Auxiliary files -- list.sh Generation of file list and directory -- format.sh Code for format GWAS summary statistics -- lz14.sh Code to extract LocusZoom 1.4 databases for analysis.sh -- analysis.sh Bash code for analysis calling analysis.ini -- metal.sh Generation/execution of METAL scripts -- METAL.qsub TORQUE qsub script for METAL -- INTERVAL.sh INTERVAL analysis -- KORA.sh Bash/R scripts to hand KORA data -- KORA.txt obsolete version to use simulated data -- KORA.R R code to simulate phenotypes -- EURLD.bed approximately independent LD blocks for Europeans. -- QCGWAS.sh QCGWAS for specific proteins, calling QCGWAS.R -- snpstats.sh sumstats/qctool -snp-stats summary, see also qctool.txt tryggve.md This document * from Jimmy In total, 92 proteins are expected as given in olink.prot.list.txt . BioFinder . 91 (no BDNF) proteins. sumstats file named after genes and converted to protein names. NSPHS . 91 (no BDNF) proteins, originally a tar.gz file is unpacked into $HOME/INF/work leading to 10 proteins EGCUT . 91 (no BDNF) proteins, orginally only 18 proteins though stratified by chromsomes INTERVAL . 92 proteins. raw SNPTEST output with information such as info/chip SNPs to be added KORA . 91 (no BDNF) proteins, age, sex and individual level imputed genotypes LifeLinesDeep . Only 1/25 proteins (unused) MadCam . 91 (no IL.6) proteins ULSAM . 25 proteins (unused) PIVUS . 23 proteins (unused) ORCADES . 91 (no BDNF) protein results are available but adding CCL3 which overlaps with MMP.1 RECOMBINE . 91 (no BDNF) protein results are available with information as described in the analysis plan VIS . 91 (no BDNF) protein restults as with ORCADES STABILITY . 90 (no BDNF, IL.2) protein. STANLEY . 91 (no BDNF) largely complete protein results for lah1 and swe6 NOTEs on results The directory contains several versions of results, Directory Version of results CEU Results excluding 18 regions in high LD HLA Similar to CEU/ bove but keeps HLA nold No exclusion of regions INTERVAL_nold nold/ result for INTERVAL The PLINK --clump-r2 0 results are included here for comparison. Comprehensive information is contained in .cis.vs.trans and cis/trans classificaiton in .out.","title":"Tryggve"},{"location":"tryggve/#tryggve","text":"Tryggve is the server used for SCALLOP and also SCALLOP-INF at earlier stage of the analysis. The document covers various aspects such as software and data.","title":"Tryggve"},{"location":"tryggve/#modules","text":"Instances are exemplified as follows, module load anaconda2/4.4.0 module load bedtools/2.28.0 module load bgen/20180807 module load perl/5.24.0 annovar/2019oct24 module load bcftools/1.9 module load emacs/26.1 module load gcta/1.91.0beta module load intel/redist/2019 intel/perflibs/64/2019 gcc/5.4.0 lapack/3.8.0 R/3.5.3-ICC-MKL rstudio/1.1.453 module load libreoffice/6.0.5.2 module load locuszoom/1.4 module load metal/20180828 module load pandoc/2.1 module load parallel/20190122 module load plink2/1.90beta5.4 module load vcftools/0.1.16 module load xpdf/3.04 export threads=1 e.g., pandoc tryggve.md -o tryggve.docx soffice tryggve.docx xterm -fa arial -fs 12 -bg black -fg white","title":"Modules"},{"location":"tryggve/#parallel-computing","text":"METAL.qsub was intended to run batch jobs under Terascale Open-source Resource and QUEue Manager (TORQUE) controls batch jobs and distributed compute nodes, enabling integration with Moab cluster suite and extending Portable Batch System (PBS) with respect to extend scalability, fault tolerance, and functionality. Information on job scheduling on Computerome is availble from https://www.computerome.dk/display/CW/Batch+System, However, the SCALLOP securitycloud is a 1-node cloud and we resort to parallel instead, e.g, module load metal/20110325 parallel/20190122 ls METAL/*.run | parallel --dry-run --env HOME -j8 -C' ' 'metal $HOME/INF/{}' NB METAL add -1 to the filenames.","title":"Parallel computing"},{"location":"tryggve/#software-issues","text":"","title":"SOFTWARE ISSUES"},{"location":"tryggve/#bash-functions","text":"There might be problems with R/3.5.3-ICC-MKL so functions are defined in .bashrc which can be invoked at the start of a session, then one invokes R.3.5.3 when necessary. # This could be very slow function R.3.5.3() { export R_LIBS=/data/$USER/R:/services/tools/R/3.5.3-ICC-MKL/lib64/R/library module load intel/redist/2019 intel/perflibs/64/2019 gcc/5.4.0 lapack/3.8.0 R/3.5.3-ICC-MKL lapack/3.8.0 source /data/jinhua/parallel-20190222/bin/env_parallel.bash alias R='/services/tools/R/3.5.3-ICC-MKL/bin/R -q $@' } # An alternative function R.3.3.1() { module load intel/redist/2019 intel/perflibs/64/2019 gcc/5.4.0 R/3.3.1-ICC-MKL } We also use R 3.3.x below.","title":"Bash functions"},{"location":"tryggve/#code-extraction","text":"This is possible with codedown, as noted here .","title":"Code extraction"},{"location":"tryggve/#locuszoom-14","text":"To use LocusZoom 1.4, one only needs to start with module load gcc/5.4.0 module load R/3.2.5 module load anaconda2/4.4.0 module load locuszoom/1.4","title":"LocusZoom 1.4"},{"location":"tryggve/#finemapldstore","text":"finemap 1.3.1 and ldstore 1.1 are available from /data/jinhua and can be enabled as follows, ln -fs /data/jinhua/ldstore_v1.1_x86_64/ldstore $HOME/bin/ldstore_v1.1 ln -fs /data/jinhua/finemap_v1.3.1_x86_64/finemap_v1.3.1_x86_64 $HOME/bin/finemap_v1.3.1 ```` finemap 1.4 and ldstore 2.0b are available from /data/jinhua/finemap-1.4. ### qctool TRYGGVE now fixed issue with qctool/2.0.1 for lack of lapack shared libraries as in /data/jinhua/lapack-3.8.0/ and its installation described on GitHub repository, https://github.com/jinghuazhao/Computational-Statistics. It is then possible to issue `module load gcc/5.4.0 lapack/3.8.0 qctool/2.0.1`. ## NEW SOFTWARE There are a number of software updates/additions which are worthy of note. ### GCTA A more recenve version is available from /data/jinhua/gcta_1.91.7beta/. This version can handle chi-squared statistics instead of p values in the joint/conditional (COJO) analysis; it also allows for `--grm file --pca --out file`, i.e., same file root. ### GNU parallel The latest version parallel-20190222 has new features and use them directly on TRYGGVE without invoking modules as follows, ```bash export src=/data/jinhua/parallel-20190222/bin for i in $(ls $src); do ln -fs $src/$i $HOME/bin/$i; done export MANPATH=/data/jinhua/parallel-20190222/share/man:$MANPATH The last line enables man parallel and info parallel .","title":"finemap/ldstore"},{"location":"tryggve/#imagemagick","text":"This is version 7.0.8-22, made available due to the inability to use the imagemagick/7.0.8-16 module, e.g., export PATH=/data/jinhua/ImageMagick-7.0.8-22/bin:$PATH convert OPG.lz-1.png -resize 130% OPG.lz-3.png convert \\( OPG.qq.png -append OPG.manhattan.png -append OPG.lz-3.png -append \\) +append OPG-qml.png used to generate the figure in the front page. Another very useful utility is its display .","title":"ImageMagick"},{"location":"tryggve/#metal","text":"The version as in /data/jinhua/METAL-2018-08-28 contains modification which allows for CUSTOMVARIABLE to use integer position rather than scientific format as in software-notes . An extension was made with the Direction column so that if a variant with '+' and '-' effects becomes 'p' and 'n', respectively with P <= 0.05. To avoid loading the default /usr/bin/metal, one can add ln -sf /data/jinhua/METAL-2018-08-28/metal $HOME/bin/metal export PATH=$HOME/bin:/data/jinhua/ImageMagick-7.0.8-22/bin:$PATH into $HOME/.bashrc.","title":"METAL"},{"location":"tryggve/#openvpn","text":"In case you see message \"All TAP-Windows aapters on this system are currently in use\", read this post , esp. install tap-windows-8.21.2 . The log is usually located at \"%USERPROFILE%/OpenVPN/log\".","title":"OpenVPN"},{"location":"tryggve/#r","text":"EasyQC/EasyStrata The version is 18.1 rather than 9.2 and 8.6 currently online, https://www.uni-regensburg.de/medizin/epidemiologie-praeventivmedizin/genetische-epidemiologie/software/. gap First, run R.3.5.3 as defined above. This version contains functions cis.vs.trans.classification, gc.lambda, invnormal, and here is the way to go module load intel/redist/2019 intel/perflibs/64/2019 gcc/5.4.0 R/3.5.3-ICC-MKL tar xvfz gap_1.2.2.tar.gz cd gap/src gcc -I/services/tools/intel/perflibs/2019/compilers_and_libraries/linux/mpi/intel64/include -L/services/tools/intel/perflibs/2019/compilers_and_libraries/linux/mpi/intel64/lib/release -L/services/tools/intel/perflibs/2019/compilers_and_libraries/linux/mpi/intel64/lib -Xlinker --enable-new-dtags -Xlinker -rpath -Xlinker /services/tools/intel/perflibs/2019/compilers_and_libraries/linux/mpi/intel64/lib/release -Xlinker -rpath -Xlinker /services/tools/intel/perflibs/2019/compilers_and_libraries/linux/mpi/intel64/lib -Xlinker -rpath -Xlinker /opt/intel/mpi-rt/2017.0.0/intel64/lib/release -Xlinker -rpath -Xlinker /opt/intel/mpi-rt/2017.0.0/intel64/lib -lmpifort -lmpi -ldl -lrt -lpthread -L/services/tools/intel/perflibs/2019//compilers_and_libraries_2019.0.117/linux/mpi/intel64/libfabric/lib -fPIC -c *.c *.f gcc -shared -L/services/tools/R/3.5.3-ICC-MKL/lib64/R/lib -L/usr/local/lib64 -o gap.so 2k.o 2ld.o cline.o gcontrol_c.o gcx.o gif_c.o hap_c.o hwe.hardy.o kin.morgan.o makeped_c.o mia.o muvar.o package_native_routine_registration_skeleton.o pfc.o pfc.sim.o pgc_c.o whscore.o -L/usr/lib/gcc/x86_64-redhat-linux/4.8.2 -lgfortran -lm -lquadmath -L/services/tools/R/3.5.3-ICC-MKL/lib64/R/lib -lR cd - R CMD INSTALL gap -l /data/jinhua/R The rather imtimidating compiler flags are derived from mpiicc -show as with initial pass requested for libfabric.so.1, and the idea is to get around check for icc which does not exist on the system. To faciliate compiling, gap.sh contains these lines for use. To take advantage of the circos.mhtplot function, package R/gap.datasets is also made available. The following is an example for cross-check, R --no-save -q <<END gz <- \"sumstats/STABILITY/STABILITY.IFN.gamma.gz\" STABILITY <- read.table(gz,as.is=TRUE,header=TRUE,sep=\"\\t\") summary(STABILITY) library(\"GenABEL\") estlambda(with(STABILITY,PVAL), method=\"median\") END Somehow R/gap thus compiled was very slow; so attempt was also made with R 3.3.1 via gap.3.3.1.sh which requires registration of routine family (defined in pfc.f ) altered to family_ and the change is made as default. The fp() function in analysis.sh requires R.3.3.1 to be called. QCGWAS The version contains fix to the use of HapMap reference as in software-notes above. The HapMap data as with code from the packages's quick guide is /data/jinhua/data/QCGWAS.","title":"R"},{"location":"tryggve/#a-summary-of-files","text":"File specification Descrription doc/ Oringal documents -- KORA.prot.preproc.belowlod.v2.R* R code for data preprocessing -- kora.normalised.prot.txt* sex, age, normalised proteins -- KORA.pc.below.llod.pdf* llod check METAL/ METAL/output scripts by protein sumstats/ File lists and study directories tryggve/ Auxiliary files -- list.sh Generation of file list and directory -- format.sh Code for format GWAS summary statistics -- lz14.sh Code to extract LocusZoom 1.4 databases for analysis.sh -- analysis.sh Bash code for analysis calling analysis.ini -- metal.sh Generation/execution of METAL scripts -- METAL.qsub TORQUE qsub script for METAL -- INTERVAL.sh INTERVAL analysis -- KORA.sh Bash/R scripts to hand KORA data -- KORA.txt obsolete version to use simulated data -- KORA.R R code to simulate phenotypes -- EURLD.bed approximately independent LD blocks for Europeans. -- QCGWAS.sh QCGWAS for specific proteins, calling QCGWAS.R -- snpstats.sh sumstats/qctool -snp-stats summary, see also qctool.txt tryggve.md This document * from Jimmy In total, 92 proteins are expected as given in olink.prot.list.txt . BioFinder . 91 (no BDNF) proteins. sumstats file named after genes and converted to protein names. NSPHS . 91 (no BDNF) proteins, originally a tar.gz file is unpacked into $HOME/INF/work leading to 10 proteins EGCUT . 91 (no BDNF) proteins, orginally only 18 proteins though stratified by chromsomes INTERVAL . 92 proteins. raw SNPTEST output with information such as info/chip SNPs to be added KORA . 91 (no BDNF) proteins, age, sex and individual level imputed genotypes LifeLinesDeep . Only 1/25 proteins (unused) MadCam . 91 (no IL.6) proteins ULSAM . 25 proteins (unused) PIVUS . 23 proteins (unused) ORCADES . 91 (no BDNF) protein results are available but adding CCL3 which overlaps with MMP.1 RECOMBINE . 91 (no BDNF) protein results are available with information as described in the analysis plan VIS . 91 (no BDNF) protein restults as with ORCADES STABILITY . 90 (no BDNF, IL.2) protein. STANLEY . 91 (no BDNF) largely complete protein results for lah1 and swe6","title":"A SUMMARY OF FILES"},{"location":"tryggve/#notes-on-results","text":"The directory contains several versions of results, Directory Version of results CEU Results excluding 18 regions in high LD HLA Similar to CEU/ bove but keeps HLA nold No exclusion of regions INTERVAL_nold nold/ result for INTERVAL The PLINK --clump-r2 0 results are included here for comparison. Comprehensive information is contained in .cis.vs.trans and cis/trans classificaiton in .out.","title":"NOTEs on results"}]}